static const char* GetResultString(unsigned result) {
  switch (result) {
    case 1879048195:
      return "ZE_RESULT_ERROR_OUT_OF_DEVICE_MEMORY";
    case 2013265930:
      return "ZE_RESULT_ERROR_UNSUPPORTED_ALIGNMENT";
    case 2013265942:
      return "ZE_RESULT_ERROR_INVALID_KERNEL_ARGUMENT_SIZE";
    case 1879113729:
      return "ZE_RESULT_ERROR_NOT_AVAILABLE";
    case 2013265936:
      return "ZE_RESULT_ERROR_INVALID_GLOBAL_NAME";
    case 1879048196:
      return "ZE_RESULT_ERROR_MODULE_BUILD_FAILURE";
    case 2013265931:
      return "ZE_RESULT_ERROR_INVALID_SYNCHRONIZATION_OBJECT";
    case 2013265926:
      return "ZE_RESULT_ERROR_HANDLE_OBJECT_IN_USE";
    case 1879048194:
      return "ZE_RESULT_ERROR_OUT_OF_HOST_MEMORY";
    case 2013265933:
      return "ZE_RESULT_ERROR_UNSUPPORTED_ENUMERATION";
    case 2013265932:
      return "ZE_RESULT_ERROR_INVALID_ENUMERATION";
    case 2013265927:
      return "ZE_RESULT_ERROR_INVALID_NULL_POINTER";
    case 2013265944:
      return "ZE_RESULT_ERROR_INVALID_MODULE_UNLINKED";
    case 2013265946:
      return "ZE_RESULT_ERROR_OVERLAPPING_REGIONS";
    case 1879048193:
      return "ZE_RESULT_ERROR_DEVICE_LOST";
    case 2013265924:
      return "ZE_RESULT_ERROR_INVALID_ARGUMENT";
    case 2013265938:
      return "ZE_RESULT_ERROR_INVALID_FUNCTION_NAME";
    case 1879179264:
      return "ZE_RESULT_ERROR_DEPENDENCY_UNAVAILABLE";
    case 2013265922:
      return "ZE_RESULT_ERROR_UNSUPPORTED_VERSION";
    case 2013265934:
      return "ZE_RESULT_ERROR_UNSUPPORTED_IMAGE_FORMAT";
    case 2013265945:
      return "ZE_RESULT_ERROR_INVALID_COMMAND_LIST_TYPE";
    case 2147483647:
      return "ZE_RESULT_FORCE_UINT32";
    case 2013265941:
      return "ZE_RESULT_ERROR_INVALID_KERNEL_ARGUMENT_INDEX";
    case 1879048197:
      return "ZE_RESULT_ERROR_MODULE_LINK_FAILURE";
    case 2013265940:
      return "ZE_RESULT_ERROR_INVALID_GLOBAL_WIDTH_DIMENSION";
    case 1:
      return "ZE_RESULT_NOT_READY";
    case 0:
      return "ZE_RESULT_SUCCESS";
    case 2013265929:
      return "ZE_RESULT_ERROR_UNSUPPORTED_SIZE";
    case 2013265925:
      return "ZE_RESULT_ERROR_INVALID_NULL_HANDLE";
    case 2147483646:
      return "ZE_RESULT_ERROR_UNKNOWN";
    case 2013265939:
      return "ZE_RESULT_ERROR_INVALID_GROUP_SIZE_DIMENSION";
    case 2013265921:
      return "ZE_RESULT_ERROR_UNINITIALIZED";
    case 2013265937:
      return "ZE_RESULT_ERROR_INVALID_KERNEL_NAME";
    case 2013265935:
      return "ZE_RESULT_ERROR_INVALID_NATIVE_BINARY";
    case 2013265928:
      return "ZE_RESULT_ERROR_INVALID_SIZE";
    case 2013265943:
      return "ZE_RESULT_ERROR_INVALID_KERNEL_ATTRIBUTE_VALUE";
    case 1879113728:
      return "ZE_RESULT_ERROR_INSUFFICIENT_PERMISSIONS";
    case 2013265923:
      return "ZE_RESULT_ERROR_UNSUPPORTED_FEATURE";
    default:
      break;
  }
  return "<UNKNOWN>";
}

static void zeInitOnEnter(
    ze_init_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeInit" << ":";
    std::cerr << " flags = " << *(params->pflags);
    std::cerr << std::endl;
  }
}

static void zeInitOnExit(
    ze_init_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeInit", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeInit" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeInit",
                         start_time, end_time);
  }
}

static void zeDriverGetOnEnter(
    ze_driver_get_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeDriverGet" << ":";
    std::cerr << " pCount = " << *(params->ppCount);
    if (*(params->ppCount) != nullptr) {
      std::cerr << " (Count = " << **(params->ppCount) << ")";
    }
    std::cerr << " phDrivers = " << *(params->pphDrivers);
    if (*(params->pphDrivers) != nullptr) {
      std::cerr << " (hDrivers = " << **(params->pphDrivers) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeDriverGetOnExit(
    ze_driver_get_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeDriverGet", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeDriverGet" << " [" << time << " ns]";
    if (*(params->ppCount) != nullptr) {
      std::cerr << " Count = " << **(params->ppCount) << "";
    }
    if (*(params->pphDrivers) != nullptr) {
      std::cerr << " hDrivers = " << **(params->pphDrivers) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeDriverGet",
                         start_time, end_time);
  }
}

static void zeDriverGetApiVersionOnEnter(
    ze_driver_get_api_version_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeDriverGetApiVersion" << ":";
    std::cerr << " hDriver = " << *(params->phDriver);
    std::cerr << " version = " << *(params->pversion);
    std::cerr << std::endl;
  }
}

static void zeDriverGetApiVersionOnExit(
    ze_driver_get_api_version_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeDriverGetApiVersion", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeDriverGetApiVersion" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeDriverGetApiVersion",
                         start_time, end_time);
  }
}

static void zeDriverGetPropertiesOnEnter(
    ze_driver_get_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeDriverGetProperties" << ":";
    std::cerr << " hDriver = " << *(params->phDriver);
    std::cerr << " pDriverProperties = " << *(params->ppDriverProperties);
    std::cerr << std::endl;
  }
}

static void zeDriverGetPropertiesOnExit(
    ze_driver_get_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeDriverGetProperties", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeDriverGetProperties" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeDriverGetProperties",
                         start_time, end_time);
  }
}

static void zeDriverGetIpcPropertiesOnEnter(
    ze_driver_get_ipc_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeDriverGetIpcProperties" << ":";
    std::cerr << " hDriver = " << *(params->phDriver);
    std::cerr << " pIpcProperties = " << *(params->ppIpcProperties);
    std::cerr << std::endl;
  }
}

static void zeDriverGetIpcPropertiesOnExit(
    ze_driver_get_ipc_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeDriverGetIpcProperties", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeDriverGetIpcProperties" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeDriverGetIpcProperties",
                         start_time, end_time);
  }
}

static void zeDriverGetExtensionPropertiesOnEnter(
    ze_driver_get_extension_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeDriverGetExtensionProperties" << ":";
    std::cerr << " hDriver = " << *(params->phDriver);
    std::cerr << " pCount = " << *(params->ppCount);
    if (*(params->ppCount) != nullptr) {
      std::cerr << " (Count = " << **(params->ppCount) << ")";
    }
    std::cerr << " pExtensionProperties = " << *(params->ppExtensionProperties);
    std::cerr << std::endl;
  }
}

static void zeDriverGetExtensionPropertiesOnExit(
    ze_driver_get_extension_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeDriverGetExtensionProperties", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeDriverGetExtensionProperties" << " [" << time << " ns]";
    if (*(params->ppCount) != nullptr) {
      std::cerr << " Count = " << **(params->ppCount) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeDriverGetExtensionProperties",
                         start_time, end_time);
  }
}

static void zeDeviceGetOnEnter(
    ze_device_get_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeDeviceGet" << ":";
    std::cerr << " hDriver = " << *(params->phDriver);
    std::cerr << " pCount = " << *(params->ppCount);
    if (*(params->ppCount) != nullptr) {
      std::cerr << " (Count = " << **(params->ppCount) << ")";
    }
    std::cerr << " phDevices = " << *(params->pphDevices);
    if (*(params->pphDevices) != nullptr) {
      std::cerr << " (hDevices = " << **(params->pphDevices) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeDeviceGetOnExit(
    ze_device_get_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeDeviceGet", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeDeviceGet" << " [" << time << " ns]";
    if (*(params->ppCount) != nullptr) {
      std::cerr << " Count = " << **(params->ppCount) << "";
    }
    if (*(params->pphDevices) != nullptr) {
      std::cerr << " hDevices = " << **(params->pphDevices) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeDeviceGet",
                         start_time, end_time);
  }
}

static void zeDeviceGetSubDevicesOnEnter(
    ze_device_get_sub_devices_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeDeviceGetSubDevices" << ":";
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " pCount = " << *(params->ppCount);
    if (*(params->ppCount) != nullptr) {
      std::cerr << " (Count = " << **(params->ppCount) << ")";
    }
    std::cerr << " phSubdevices = " << *(params->pphSubdevices);
    if (*(params->pphSubdevices) != nullptr) {
      std::cerr << " (hSubdevices = " << **(params->pphSubdevices) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeDeviceGetSubDevicesOnExit(
    ze_device_get_sub_devices_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeDeviceGetSubDevices", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeDeviceGetSubDevices" << " [" << time << " ns]";
    if (*(params->ppCount) != nullptr) {
      std::cerr << " Count = " << **(params->ppCount) << "";
    }
    if (*(params->pphSubdevices) != nullptr) {
      std::cerr << " hSubdevices = " << **(params->pphSubdevices) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeDeviceGetSubDevices",
                         start_time, end_time);
  }
}

static void zeDeviceGetPropertiesOnEnter(
    ze_device_get_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeDeviceGetProperties" << ":";
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " pDeviceProperties = " << *(params->ppDeviceProperties);
    std::cerr << std::endl;
  }
}

static void zeDeviceGetPropertiesOnExit(
    ze_device_get_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeDeviceGetProperties", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeDeviceGetProperties" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeDeviceGetProperties",
                         start_time, end_time);
  }
}

static void zeDeviceGetComputePropertiesOnEnter(
    ze_device_get_compute_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeDeviceGetComputeProperties" << ":";
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " pComputeProperties = " << *(params->ppComputeProperties);
    std::cerr << std::endl;
  }
}

static void zeDeviceGetComputePropertiesOnExit(
    ze_device_get_compute_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeDeviceGetComputeProperties", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeDeviceGetComputeProperties" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeDeviceGetComputeProperties",
                         start_time, end_time);
  }
}

static void zeDeviceGetModulePropertiesOnEnter(
    ze_device_get_module_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeDeviceGetModuleProperties" << ":";
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " pModuleProperties = " << *(params->ppModuleProperties);
    std::cerr << std::endl;
  }
}

static void zeDeviceGetModulePropertiesOnExit(
    ze_device_get_module_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeDeviceGetModuleProperties", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeDeviceGetModuleProperties" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeDeviceGetModuleProperties",
                         start_time, end_time);
  }
}

static void zeDeviceGetCommandQueueGroupPropertiesOnEnter(
    ze_device_get_command_queue_group_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeDeviceGetCommandQueueGroupProperties" << ":";
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " pCount = " << *(params->ppCount);
    if (*(params->ppCount) != nullptr) {
      std::cerr << " (Count = " << **(params->ppCount) << ")";
    }
    std::cerr << " pCommandQueueGroupProperties = " << *(params->ppCommandQueueGroupProperties);
    std::cerr << std::endl;
  }
}

static void zeDeviceGetCommandQueueGroupPropertiesOnExit(
    ze_device_get_command_queue_group_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeDeviceGetCommandQueueGroupProperties", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeDeviceGetCommandQueueGroupProperties" << " [" << time << " ns]";
    if (*(params->ppCount) != nullptr) {
      std::cerr << " Count = " << **(params->ppCount) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeDeviceGetCommandQueueGroupProperties",
                         start_time, end_time);
  }
}

static void zeDeviceGetMemoryPropertiesOnEnter(
    ze_device_get_memory_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeDeviceGetMemoryProperties" << ":";
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " pCount = " << *(params->ppCount);
    if (*(params->ppCount) != nullptr) {
      std::cerr << " (Count = " << **(params->ppCount) << ")";
    }
    std::cerr << " pMemProperties = " << *(params->ppMemProperties);
    std::cerr << std::endl;
  }
}

static void zeDeviceGetMemoryPropertiesOnExit(
    ze_device_get_memory_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeDeviceGetMemoryProperties", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeDeviceGetMemoryProperties" << " [" << time << " ns]";
    if (*(params->ppCount) != nullptr) {
      std::cerr << " Count = " << **(params->ppCount) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeDeviceGetMemoryProperties",
                         start_time, end_time);
  }
}

static void zeDeviceGetMemoryAccessPropertiesOnEnter(
    ze_device_get_memory_access_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeDeviceGetMemoryAccessProperties" << ":";
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " pMemAccessProperties = " << *(params->ppMemAccessProperties);
    std::cerr << std::endl;
  }
}

static void zeDeviceGetMemoryAccessPropertiesOnExit(
    ze_device_get_memory_access_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeDeviceGetMemoryAccessProperties", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeDeviceGetMemoryAccessProperties" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeDeviceGetMemoryAccessProperties",
                         start_time, end_time);
  }
}

static void zeDeviceGetCachePropertiesOnEnter(
    ze_device_get_cache_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeDeviceGetCacheProperties" << ":";
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " pCount = " << *(params->ppCount);
    if (*(params->ppCount) != nullptr) {
      std::cerr << " (Count = " << **(params->ppCount) << ")";
    }
    std::cerr << " pCacheProperties = " << *(params->ppCacheProperties);
    std::cerr << std::endl;
  }
}

static void zeDeviceGetCachePropertiesOnExit(
    ze_device_get_cache_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeDeviceGetCacheProperties", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeDeviceGetCacheProperties" << " [" << time << " ns]";
    if (*(params->ppCount) != nullptr) {
      std::cerr << " Count = " << **(params->ppCount) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeDeviceGetCacheProperties",
                         start_time, end_time);
  }
}

static void zeDeviceGetImagePropertiesOnEnter(
    ze_device_get_image_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeDeviceGetImageProperties" << ":";
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " pImageProperties = " << *(params->ppImageProperties);
    std::cerr << std::endl;
  }
}

static void zeDeviceGetImagePropertiesOnExit(
    ze_device_get_image_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeDeviceGetImageProperties", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeDeviceGetImageProperties" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeDeviceGetImageProperties",
                         start_time, end_time);
  }
}

static void zeDeviceGetExternalMemoryPropertiesOnEnter(
    ze_device_get_external_memory_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeDeviceGetExternalMemoryProperties" << ":";
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " pExternalMemoryProperties = " << *(params->ppExternalMemoryProperties);
    std::cerr << std::endl;
  }
}

static void zeDeviceGetExternalMemoryPropertiesOnExit(
    ze_device_get_external_memory_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeDeviceGetExternalMemoryProperties", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeDeviceGetExternalMemoryProperties" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeDeviceGetExternalMemoryProperties",
                         start_time, end_time);
  }
}

static void zeDeviceGetP2PPropertiesOnEnter(
    ze_device_get_p2_p_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeDeviceGetP2PProperties" << ":";
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " hPeerDevice = " << *(params->phPeerDevice);
    std::cerr << " pP2PProperties = " << *(params->ppP2PProperties);
    std::cerr << std::endl;
  }
}

static void zeDeviceGetP2PPropertiesOnExit(
    ze_device_get_p2_p_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeDeviceGetP2PProperties", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeDeviceGetP2PProperties" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeDeviceGetP2PProperties",
                         start_time, end_time);
  }
}

static void zeDeviceCanAccessPeerOnEnter(
    ze_device_can_access_peer_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeDeviceCanAccessPeer" << ":";
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " hPeerDevice = " << *(params->phPeerDevice);
    std::cerr << " value = " << *(params->pvalue);
    std::cerr << std::endl;
  }
}

static void zeDeviceCanAccessPeerOnExit(
    ze_device_can_access_peer_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeDeviceCanAccessPeer", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeDeviceCanAccessPeer" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeDeviceCanAccessPeer",
                         start_time, end_time);
  }
}

static void zeDeviceGetStatusOnEnter(
    ze_device_get_status_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeDeviceGetStatus" << ":";
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << std::endl;
  }
}

static void zeDeviceGetStatusOnExit(
    ze_device_get_status_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeDeviceGetStatus", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeDeviceGetStatus" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeDeviceGetStatus",
                         start_time, end_time);
  }
}

static void zeContextCreateOnEnter(
    ze_context_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeContextCreate" << ":";
    std::cerr << " hDriver = " << *(params->phDriver);
    std::cerr << " desc = " << *(params->pdesc);
    std::cerr << " phContext = " << *(params->pphContext);
    if (*(params->pphContext) != nullptr) {
      std::cerr << " (hContext = " << **(params->pphContext) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeContextCreateOnExit(
    ze_context_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeContextCreate", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeContextCreate" << " [" << time << " ns]";
    if (*(params->pphContext) != nullptr) {
      std::cerr << " hContext = " << **(params->pphContext) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeContextCreate",
                         start_time, end_time);
  }
}

static void zeContextDestroyOnEnter(
    ze_context_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeContextDestroy" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << std::endl;
  }
}

static void zeContextDestroyOnExit(
    ze_context_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeContextDestroy", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeContextDestroy" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeContextDestroy",
                         start_time, end_time);
  }
}

static void zeContextGetStatusOnEnter(
    ze_context_get_status_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeContextGetStatus" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << std::endl;
  }
}

static void zeContextGetStatusOnExit(
    ze_context_get_status_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeContextGetStatus", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeContextGetStatus" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeContextGetStatus",
                         start_time, end_time);
  }
}

static void zeContextSystemBarrierOnEnter(
    ze_context_system_barrier_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeContextSystemBarrier" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << std::endl;
  }
}

static void zeContextSystemBarrierOnExit(
    ze_context_system_barrier_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeContextSystemBarrier", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeContextSystemBarrier" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeContextSystemBarrier",
                         start_time, end_time);
  }
}

static void zeContextMakeMemoryResidentOnEnter(
    ze_context_make_memory_resident_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeContextMakeMemoryResident" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " ptr = " << *(params->pptr);
    std::cerr << " size = " << *(params->psize);
    std::cerr << std::endl;
  }
}

static void zeContextMakeMemoryResidentOnExit(
    ze_context_make_memory_resident_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeContextMakeMemoryResident", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeContextMakeMemoryResident" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeContextMakeMemoryResident",
                         start_time, end_time);
  }
}

static void zeContextEvictMemoryOnEnter(
    ze_context_evict_memory_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeContextEvictMemory" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " ptr = " << *(params->pptr);
    std::cerr << " size = " << *(params->psize);
    std::cerr << std::endl;
  }
}

static void zeContextEvictMemoryOnExit(
    ze_context_evict_memory_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeContextEvictMemory", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeContextEvictMemory" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeContextEvictMemory",
                         start_time, end_time);
  }
}

static void zeContextMakeImageResidentOnEnter(
    ze_context_make_image_resident_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeContextMakeImageResident" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " hImage = " << *(params->phImage);
    std::cerr << std::endl;
  }
}

static void zeContextMakeImageResidentOnExit(
    ze_context_make_image_resident_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeContextMakeImageResident", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeContextMakeImageResident" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeContextMakeImageResident",
                         start_time, end_time);
  }
}

static void zeContextEvictImageOnEnter(
    ze_context_evict_image_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeContextEvictImage" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " hImage = " << *(params->phImage);
    std::cerr << std::endl;
  }
}

static void zeContextEvictImageOnExit(
    ze_context_evict_image_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeContextEvictImage", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeContextEvictImage" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeContextEvictImage",
                         start_time, end_time);
  }
}

static void zeCommandQueueCreateOnEnter(
    ze_command_queue_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandQueueCreate" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " desc = " << *(params->pdesc);
    if (*(params->pdesc) != nullptr) {
      std::cerr << " {" << (*(params->pdesc))->stype << " ";
      std::cerr << (*(params->pdesc))->pNext << " ";
      std::cerr << (*(params->pdesc))->ordinal << " ";
      std::cerr << (*(params->pdesc))->index << " ";
      std::cerr << (*(params->pdesc))->flags << " ";
      std::cerr << (*(params->pdesc))->mode << " ";
      std::cerr << (*(params->pdesc))->priority << "}";
    }
    std::cerr << " phCommandQueue = " << *(params->pphCommandQueue);
    if (*(params->pphCommandQueue) != nullptr) {
      std::cerr << " (hCommandQueue = " << **(params->pphCommandQueue) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeCommandQueueCreateOnExit(
    ze_command_queue_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandQueueCreate", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandQueueCreate" << " [" << time << " ns]";
    if (*(params->pphCommandQueue) != nullptr) {
      std::cerr << " hCommandQueue = " << **(params->pphCommandQueue) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandQueueCreate",
                         start_time, end_time);
  }
}

static void zeCommandQueueDestroyOnEnter(
    ze_command_queue_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandQueueDestroy" << ":";
    std::cerr << " hCommandQueue = " << *(params->phCommandQueue);
    std::cerr << std::endl;
  }
}

static void zeCommandQueueDestroyOnExit(
    ze_command_queue_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandQueueDestroy", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandQueueDestroy" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandQueueDestroy",
                         start_time, end_time);
  }
}

static void zeCommandQueueExecuteCommandListsOnEnter(
    ze_command_queue_execute_command_lists_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandQueueExecuteCommandLists" << ":";
    std::cerr << " hCommandQueue = " << *(params->phCommandQueue);
    std::cerr << " numCommandLists = " << *(params->pnumCommandLists);
    std::cerr << " phCommandLists = " << *(params->pphCommandLists);
    if (*(params->pphCommandLists) != nullptr) {
      std::cerr << " (hCommandLists = " << **(params->pphCommandLists) << ")";
    }
    std::cerr << " hFence = " << *(params->phFence);
    std::cerr << std::endl;
  }
}

static void zeCommandQueueExecuteCommandListsOnExit(
    ze_command_queue_execute_command_lists_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandQueueExecuteCommandLists", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandQueueExecuteCommandLists" << " [" << time << " ns]";
    if (*(params->pphCommandLists) != nullptr) {
      std::cerr << " hCommandLists = " << **(params->pphCommandLists) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandQueueExecuteCommandLists",
                         start_time, end_time);
  }
}

static void zeCommandQueueSynchronizeOnEnter(
    ze_command_queue_synchronize_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandQueueSynchronize" << ":";
    std::cerr << " hCommandQueue = " << *(params->phCommandQueue);
    std::cerr << " timeout = " << *(params->ptimeout);
    std::cerr << std::endl;
  }
}

static void zeCommandQueueSynchronizeOnExit(
    ze_command_queue_synchronize_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandQueueSynchronize", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandQueueSynchronize" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandQueueSynchronize",
                         start_time, end_time);
  }
}

static void zeCommandListCreateOnEnter(
    ze_command_list_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListCreate" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " desc = " << *(params->pdesc);
    std::cerr << " phCommandList = " << *(params->pphCommandList);
    if (*(params->pphCommandList) != nullptr) {
      std::cerr << " (hCommandList = " << **(params->pphCommandList) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeCommandListCreateOnExit(
    ze_command_list_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListCreate", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListCreate" << " [" << time << " ns]";
    if (*(params->pphCommandList) != nullptr) {
      std::cerr << " hCommandList = " << **(params->pphCommandList) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListCreate",
                         start_time, end_time);
  }
}

static void zeCommandListCreateImmediateOnEnter(
    ze_command_list_create_immediate_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListCreateImmediate" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " altdesc = " << *(params->paltdesc);
    if (*(params->paltdesc) != nullptr) {
      std::cerr << " {" << (*(params->paltdesc))->stype << " ";
      std::cerr << (*(params->paltdesc))->pNext << " ";
      std::cerr << (*(params->paltdesc))->ordinal << " ";
      std::cerr << (*(params->paltdesc))->index << " ";
      std::cerr << (*(params->paltdesc))->flags << " ";
      std::cerr << (*(params->paltdesc))->mode << " ";
      std::cerr << (*(params->paltdesc))->priority << "}";
    }
    std::cerr << " phCommandList = " << *(params->pphCommandList);
    if (*(params->pphCommandList) != nullptr) {
      std::cerr << " (hCommandList = " << **(params->pphCommandList) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeCommandListCreateImmediateOnExit(
    ze_command_list_create_immediate_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListCreateImmediate", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListCreateImmediate" << " [" << time << " ns]";
    if (*(params->pphCommandList) != nullptr) {
      std::cerr << " hCommandList = " << **(params->pphCommandList) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListCreateImmediate",
                         start_time, end_time);
  }
}

static void zeCommandListDestroyOnEnter(
    ze_command_list_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListDestroy" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << std::endl;
  }
}

static void zeCommandListDestroyOnExit(
    ze_command_list_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListDestroy", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListDestroy" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListDestroy",
                         start_time, end_time);
  }
}

static void zeCommandListCloseOnEnter(
    ze_command_list_close_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListClose" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << std::endl;
  }
}

static void zeCommandListCloseOnExit(
    ze_command_list_close_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListClose", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListClose" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListClose",
                         start_time, end_time);
  }
}

static void zeCommandListResetOnEnter(
    ze_command_list_reset_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListReset" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << std::endl;
  }
}

static void zeCommandListResetOnExit(
    ze_command_list_reset_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListReset", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListReset" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListReset",
                         start_time, end_time);
  }
}

static void zeCommandListAppendWriteGlobalTimestampOnEnter(
    ze_command_list_append_write_global_timestamp_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListAppendWriteGlobalTimestamp" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << " dstptr = " << *(params->pdstptr);
    std::cerr << " hSignalEvent = " << *(params->phSignalEvent);
    std::cerr << " numWaitEvents = " << *(params->pnumWaitEvents);
    std::cerr << " phWaitEvents = " << *(params->pphWaitEvents);
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " (hWaitEvents = " << **(params->pphWaitEvents) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeCommandListAppendWriteGlobalTimestampOnExit(
    ze_command_list_append_write_global_timestamp_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListAppendWriteGlobalTimestamp", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListAppendWriteGlobalTimestamp" << " [" << time << " ns]";
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " hWaitEvents = " << **(params->pphWaitEvents) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListAppendWriteGlobalTimestamp",
                         start_time, end_time);
  }
}

static void zeCommandListAppendBarrierOnEnter(
    ze_command_list_append_barrier_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListAppendBarrier" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << " hSignalEvent = " << *(params->phSignalEvent);
    std::cerr << " numWaitEvents = " << *(params->pnumWaitEvents);
    std::cerr << " phWaitEvents = " << *(params->pphWaitEvents);
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " (hWaitEvents = " << **(params->pphWaitEvents) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeCommandListAppendBarrierOnExit(
    ze_command_list_append_barrier_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListAppendBarrier", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListAppendBarrier" << " [" << time << " ns]";
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " hWaitEvents = " << **(params->pphWaitEvents) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListAppendBarrier",
                         start_time, end_time);
  }
}

static void zeCommandListAppendMemoryRangesBarrierOnEnter(
    ze_command_list_append_memory_ranges_barrier_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListAppendMemoryRangesBarrier" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << " numRanges = " << *(params->pnumRanges);
    std::cerr << " pRangeSizes = " << *(params->ppRangeSizes);
    std::cerr << " pRanges = " << *(params->ppRanges);
    std::cerr << " hSignalEvent = " << *(params->phSignalEvent);
    std::cerr << " numWaitEvents = " << *(params->pnumWaitEvents);
    std::cerr << " phWaitEvents = " << *(params->pphWaitEvents);
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " (hWaitEvents = " << **(params->pphWaitEvents) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeCommandListAppendMemoryRangesBarrierOnExit(
    ze_command_list_append_memory_ranges_barrier_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListAppendMemoryRangesBarrier", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListAppendMemoryRangesBarrier" << " [" << time << " ns]";
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " hWaitEvents = " << **(params->pphWaitEvents) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListAppendMemoryRangesBarrier",
                         start_time, end_time);
  }
}

static void zeCommandListAppendMemoryCopyOnEnter(
    ze_command_list_append_memory_copy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListAppendMemoryCopy" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << " dstptr = " << *(params->pdstptr);
    std::cerr << " srcptr = " << *(params->psrcptr);
    std::cerr << " size = " << *(params->psize);
    std::cerr << " hSignalEvent = " << *(params->phSignalEvent);
    std::cerr << " numWaitEvents = " << *(params->pnumWaitEvents);
    std::cerr << " phWaitEvents = " << *(params->pphWaitEvents);
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " (hWaitEvents = " << **(params->pphWaitEvents) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeCommandListAppendMemoryCopyOnExit(
    ze_command_list_append_memory_copy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListAppendMemoryCopy", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListAppendMemoryCopy" << " [" << time << " ns]";
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " hWaitEvents = " << **(params->pphWaitEvents) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListAppendMemoryCopy",
                         start_time, end_time);
  }
}

static void zeCommandListAppendMemoryFillOnEnter(
    ze_command_list_append_memory_fill_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListAppendMemoryFill" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << " ptr = " << *(params->pptr);
    std::cerr << " pattern = " << *(params->ppattern);
    std::cerr << " pattern_size = " << *(params->ppattern_size);
    std::cerr << " size = " << *(params->psize);
    std::cerr << " hSignalEvent = " << *(params->phSignalEvent);
    std::cerr << " numWaitEvents = " << *(params->pnumWaitEvents);
    std::cerr << " phWaitEvents = " << *(params->pphWaitEvents);
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " (hWaitEvents = " << **(params->pphWaitEvents) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeCommandListAppendMemoryFillOnExit(
    ze_command_list_append_memory_fill_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListAppendMemoryFill", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListAppendMemoryFill" << " [" << time << " ns]";
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " hWaitEvents = " << **(params->pphWaitEvents) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListAppendMemoryFill",
                         start_time, end_time);
  }
}

static void zeCommandListAppendMemoryCopyRegionOnEnter(
    ze_command_list_append_memory_copy_region_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListAppendMemoryCopyRegion" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << " dstptr = " << *(params->pdstptr);
    std::cerr << " dstRegion = " << *(params->pdstRegion);
    std::cerr << " dstPitch = " << *(params->pdstPitch);
    std::cerr << " dstSlicePitch = " << *(params->pdstSlicePitch);
    std::cerr << " srcptr = " << *(params->psrcptr);
    std::cerr << " srcRegion = " << *(params->psrcRegion);
    std::cerr << " srcPitch = " << *(params->psrcPitch);
    std::cerr << " srcSlicePitch = " << *(params->psrcSlicePitch);
    std::cerr << " hSignalEvent = " << *(params->phSignalEvent);
    std::cerr << " numWaitEvents = " << *(params->pnumWaitEvents);
    std::cerr << " phWaitEvents = " << *(params->pphWaitEvents);
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " (hWaitEvents = " << **(params->pphWaitEvents) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeCommandListAppendMemoryCopyRegionOnExit(
    ze_command_list_append_memory_copy_region_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListAppendMemoryCopyRegion", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListAppendMemoryCopyRegion" << " [" << time << " ns]";
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " hWaitEvents = " << **(params->pphWaitEvents) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListAppendMemoryCopyRegion",
                         start_time, end_time);
  }
}

static void zeCommandListAppendMemoryCopyFromContextOnEnter(
    ze_command_list_append_memory_copy_from_context_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListAppendMemoryCopyFromContext" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << " dstptr = " << *(params->pdstptr);
    std::cerr << " hContextSrc = " << *(params->phContextSrc);
    std::cerr << " srcptr = " << *(params->psrcptr);
    std::cerr << " size = " << *(params->psize);
    std::cerr << " hSignalEvent = " << *(params->phSignalEvent);
    std::cerr << " numWaitEvents = " << *(params->pnumWaitEvents);
    std::cerr << " phWaitEvents = " << *(params->pphWaitEvents);
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " (hWaitEvents = " << **(params->pphWaitEvents) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeCommandListAppendMemoryCopyFromContextOnExit(
    ze_command_list_append_memory_copy_from_context_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListAppendMemoryCopyFromContext", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListAppendMemoryCopyFromContext" << " [" << time << " ns]";
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " hWaitEvents = " << **(params->pphWaitEvents) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListAppendMemoryCopyFromContext",
                         start_time, end_time);
  }
}

static void zeCommandListAppendImageCopyOnEnter(
    ze_command_list_append_image_copy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListAppendImageCopy" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << " hDstImage = " << *(params->phDstImage);
    std::cerr << " hSrcImage = " << *(params->phSrcImage);
    std::cerr << " hSignalEvent = " << *(params->phSignalEvent);
    std::cerr << " numWaitEvents = " << *(params->pnumWaitEvents);
    std::cerr << " phWaitEvents = " << *(params->pphWaitEvents);
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " (hWaitEvents = " << **(params->pphWaitEvents) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeCommandListAppendImageCopyOnExit(
    ze_command_list_append_image_copy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListAppendImageCopy", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListAppendImageCopy" << " [" << time << " ns]";
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " hWaitEvents = " << **(params->pphWaitEvents) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListAppendImageCopy",
                         start_time, end_time);
  }
}

static void zeCommandListAppendImageCopyRegionOnEnter(
    ze_command_list_append_image_copy_region_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListAppendImageCopyRegion" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << " hDstImage = " << *(params->phDstImage);
    std::cerr << " hSrcImage = " << *(params->phSrcImage);
    std::cerr << " pDstRegion = " << *(params->ppDstRegion);
    std::cerr << " pSrcRegion = " << *(params->ppSrcRegion);
    std::cerr << " hSignalEvent = " << *(params->phSignalEvent);
    std::cerr << " numWaitEvents = " << *(params->pnumWaitEvents);
    std::cerr << " phWaitEvents = " << *(params->pphWaitEvents);
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " (hWaitEvents = " << **(params->pphWaitEvents) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeCommandListAppendImageCopyRegionOnExit(
    ze_command_list_append_image_copy_region_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListAppendImageCopyRegion", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListAppendImageCopyRegion" << " [" << time << " ns]";
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " hWaitEvents = " << **(params->pphWaitEvents) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListAppendImageCopyRegion",
                         start_time, end_time);
  }
}

static void zeCommandListAppendImageCopyToMemoryOnEnter(
    ze_command_list_append_image_copy_to_memory_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListAppendImageCopyToMemory" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << " dstptr = " << *(params->pdstptr);
    std::cerr << " hSrcImage = " << *(params->phSrcImage);
    std::cerr << " pSrcRegion = " << *(params->ppSrcRegion);
    std::cerr << " hSignalEvent = " << *(params->phSignalEvent);
    std::cerr << " numWaitEvents = " << *(params->pnumWaitEvents);
    std::cerr << " phWaitEvents = " << *(params->pphWaitEvents);
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " (hWaitEvents = " << **(params->pphWaitEvents) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeCommandListAppendImageCopyToMemoryOnExit(
    ze_command_list_append_image_copy_to_memory_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListAppendImageCopyToMemory", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListAppendImageCopyToMemory" << " [" << time << " ns]";
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " hWaitEvents = " << **(params->pphWaitEvents) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListAppendImageCopyToMemory",
                         start_time, end_time);
  }
}

static void zeCommandListAppendImageCopyFromMemoryOnEnter(
    ze_command_list_append_image_copy_from_memory_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListAppendImageCopyFromMemory" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << " hDstImage = " << *(params->phDstImage);
    std::cerr << " srcptr = " << *(params->psrcptr);
    std::cerr << " pDstRegion = " << *(params->ppDstRegion);
    std::cerr << " hSignalEvent = " << *(params->phSignalEvent);
    std::cerr << " numWaitEvents = " << *(params->pnumWaitEvents);
    std::cerr << " phWaitEvents = " << *(params->pphWaitEvents);
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " (hWaitEvents = " << **(params->pphWaitEvents) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeCommandListAppendImageCopyFromMemoryOnExit(
    ze_command_list_append_image_copy_from_memory_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListAppendImageCopyFromMemory", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListAppendImageCopyFromMemory" << " [" << time << " ns]";
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " hWaitEvents = " << **(params->pphWaitEvents) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListAppendImageCopyFromMemory",
                         start_time, end_time);
  }
}

static void zeCommandListAppendMemoryPrefetchOnEnter(
    ze_command_list_append_memory_prefetch_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListAppendMemoryPrefetch" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << " ptr = " << *(params->pptr);
    std::cerr << " size = " << *(params->psize);
    std::cerr << std::endl;
  }
}

static void zeCommandListAppendMemoryPrefetchOnExit(
    ze_command_list_append_memory_prefetch_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListAppendMemoryPrefetch", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListAppendMemoryPrefetch" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListAppendMemoryPrefetch",
                         start_time, end_time);
  }
}

static void zeCommandListAppendMemAdviseOnEnter(
    ze_command_list_append_mem_advise_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListAppendMemAdvise" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " ptr = " << *(params->pptr);
    std::cerr << " size = " << *(params->psize);
    std::cerr << " advice = " << *(params->padvice);
    std::cerr << " (";
    switch (*(params->padvice)) {
      case 2:
        std::cerr << "ZE_MEMORY_ADVICE_SET_PREFERRED_LOCATION";
        break;
      case 0:
        std::cerr << "ZE_MEMORY_ADVICE_SET_READ_MOSTLY";
        break;
      case 6:
        std::cerr << "ZE_MEMORY_ADVICE_BIAS_CACHED";
        break;
      case 4:
        std::cerr << "ZE_MEMORY_ADVICE_SET_NON_ATOMIC_MOSTLY";
        break;
      case 2147483647:
        std::cerr << "ZE_MEMORY_ADVICE_FORCE_UINT32";
        break;
      case 3:
        std::cerr << "ZE_MEMORY_ADVICE_CLEAR_PREFERRED_LOCATION";
        break;
      case 1:
        std::cerr << "ZE_MEMORY_ADVICE_CLEAR_READ_MOSTLY";
        break;
      case 7:
        std::cerr << "ZE_MEMORY_ADVICE_BIAS_UNCACHED";
        break;
      case 5:
        std::cerr << "ZE_MEMORY_ADVICE_CLEAR_NON_ATOMIC_MOSTLY";
        break;
      default:
        std::cerr << "<UNKNOWN>";
        break;
    }
    std::cerr << ")";
    std::cerr << std::endl;
  }
}

static void zeCommandListAppendMemAdviseOnExit(
    ze_command_list_append_mem_advise_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListAppendMemAdvise", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListAppendMemAdvise" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListAppendMemAdvise",
                         start_time, end_time);
  }
}

static void zeCommandListAppendSignalEventOnEnter(
    ze_command_list_append_signal_event_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListAppendSignalEvent" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << " hEvent = " << *(params->phEvent);
    std::cerr << std::endl;
  }
}

static void zeCommandListAppendSignalEventOnExit(
    ze_command_list_append_signal_event_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListAppendSignalEvent", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListAppendSignalEvent" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListAppendSignalEvent",
                         start_time, end_time);
  }
}

static void zeCommandListAppendWaitOnEventsOnEnter(
    ze_command_list_append_wait_on_events_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListAppendWaitOnEvents" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << " numEvents = " << *(params->pnumEvents);
    std::cerr << " phEvents = " << *(params->pphEvents);
    if (*(params->pphEvents) != nullptr) {
      std::cerr << " (hEvents = " << **(params->pphEvents) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeCommandListAppendWaitOnEventsOnExit(
    ze_command_list_append_wait_on_events_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListAppendWaitOnEvents", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListAppendWaitOnEvents" << " [" << time << " ns]";
    if (*(params->pphEvents) != nullptr) {
      std::cerr << " hEvents = " << **(params->pphEvents) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListAppendWaitOnEvents",
                         start_time, end_time);
  }
}

static void zeCommandListAppendEventResetOnEnter(
    ze_command_list_append_event_reset_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListAppendEventReset" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << " hEvent = " << *(params->phEvent);
    std::cerr << std::endl;
  }
}

static void zeCommandListAppendEventResetOnExit(
    ze_command_list_append_event_reset_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListAppendEventReset", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListAppendEventReset" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListAppendEventReset",
                         start_time, end_time);
  }
}

static void zeCommandListAppendQueryKernelTimestampsOnEnter(
    ze_command_list_append_query_kernel_timestamps_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListAppendQueryKernelTimestamps" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << " numEvents = " << *(params->pnumEvents);
    std::cerr << " phEvents = " << *(params->pphEvents);
    if (*(params->pphEvents) != nullptr) {
      std::cerr << " (hEvents = " << **(params->pphEvents) << ")";
    }
    std::cerr << " dstptr = " << *(params->pdstptr);
    std::cerr << " pOffsets = " << *(params->ppOffsets);
    std::cerr << " hSignalEvent = " << *(params->phSignalEvent);
    std::cerr << " numWaitEvents = " << *(params->pnumWaitEvents);
    std::cerr << " phWaitEvents = " << *(params->pphWaitEvents);
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " (hWaitEvents = " << **(params->pphWaitEvents) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeCommandListAppendQueryKernelTimestampsOnExit(
    ze_command_list_append_query_kernel_timestamps_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListAppendQueryKernelTimestamps", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListAppendQueryKernelTimestamps" << " [" << time << " ns]";
    if (*(params->pphEvents) != nullptr) {
      std::cerr << " hEvents = " << **(params->pphEvents) << "";
    }
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " hWaitEvents = " << **(params->pphWaitEvents) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListAppendQueryKernelTimestamps",
                         start_time, end_time);
  }
}

static void zeCommandListAppendLaunchKernelOnEnter(
    ze_command_list_append_launch_kernel_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListAppendLaunchKernel" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << " hKernel = " << *(params->phKernel);
    std::cerr << " pLaunchFuncArgs = " << *(params->ppLaunchFuncArgs);
    std::cerr << " hSignalEvent = " << *(params->phSignalEvent);
    std::cerr << " numWaitEvents = " << *(params->pnumWaitEvents);
    std::cerr << " phWaitEvents = " << *(params->pphWaitEvents);
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " (hWaitEvents = " << **(params->pphWaitEvents) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeCommandListAppendLaunchKernelOnExit(
    ze_command_list_append_launch_kernel_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListAppendLaunchKernel", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListAppendLaunchKernel" << " [" << time << " ns]";
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " hWaitEvents = " << **(params->pphWaitEvents) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListAppendLaunchKernel",
                         start_time, end_time);
  }
}

static void zeCommandListAppendLaunchCooperativeKernelOnEnter(
    ze_command_list_append_launch_cooperative_kernel_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListAppendLaunchCooperativeKernel" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << " hKernel = " << *(params->phKernel);
    std::cerr << " pLaunchFuncArgs = " << *(params->ppLaunchFuncArgs);
    std::cerr << " hSignalEvent = " << *(params->phSignalEvent);
    std::cerr << " numWaitEvents = " << *(params->pnumWaitEvents);
    std::cerr << " phWaitEvents = " << *(params->pphWaitEvents);
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " (hWaitEvents = " << **(params->pphWaitEvents) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeCommandListAppendLaunchCooperativeKernelOnExit(
    ze_command_list_append_launch_cooperative_kernel_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListAppendLaunchCooperativeKernel", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListAppendLaunchCooperativeKernel" << " [" << time << " ns]";
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " hWaitEvents = " << **(params->pphWaitEvents) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListAppendLaunchCooperativeKernel",
                         start_time, end_time);
  }
}

static void zeCommandListAppendLaunchKernelIndirectOnEnter(
    ze_command_list_append_launch_kernel_indirect_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListAppendLaunchKernelIndirect" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << " hKernel = " << *(params->phKernel);
    std::cerr << " pLaunchArgumentsBuffer = " << *(params->ppLaunchArgumentsBuffer);
    std::cerr << " hSignalEvent = " << *(params->phSignalEvent);
    std::cerr << " numWaitEvents = " << *(params->pnumWaitEvents);
    std::cerr << " phWaitEvents = " << *(params->pphWaitEvents);
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " (hWaitEvents = " << **(params->pphWaitEvents) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeCommandListAppendLaunchKernelIndirectOnExit(
    ze_command_list_append_launch_kernel_indirect_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListAppendLaunchKernelIndirect", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListAppendLaunchKernelIndirect" << " [" << time << " ns]";
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " hWaitEvents = " << **(params->pphWaitEvents) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListAppendLaunchKernelIndirect",
                         start_time, end_time);
  }
}

static void zeCommandListAppendLaunchMultipleKernelsIndirectOnEnter(
    ze_command_list_append_launch_multiple_kernels_indirect_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeCommandListAppendLaunchMultipleKernelsIndirect" << ":";
    std::cerr << " hCommandList = " << *(params->phCommandList);
    std::cerr << " numKernels = " << *(params->pnumKernels);
    std::cerr << " phKernels = " << *(params->pphKernels);
    if (*(params->pphKernels) != nullptr) {
      std::cerr << " (hKernels = " << **(params->pphKernels) << ")";
    }
    std::cerr << " pCountBuffer = " << *(params->ppCountBuffer);
    if (*(params->ppCountBuffer) != nullptr) {
      std::cerr << " (CountBuffer = " << **(params->ppCountBuffer) << ")";
    }
    std::cerr << " pLaunchArgumentsBuffer = " << *(params->ppLaunchArgumentsBuffer);
    std::cerr << " hSignalEvent = " << *(params->phSignalEvent);
    std::cerr << " numWaitEvents = " << *(params->pnumWaitEvents);
    std::cerr << " phWaitEvents = " << *(params->pphWaitEvents);
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " (hWaitEvents = " << **(params->pphWaitEvents) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeCommandListAppendLaunchMultipleKernelsIndirectOnExit(
    ze_command_list_append_launch_multiple_kernels_indirect_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeCommandListAppendLaunchMultipleKernelsIndirect", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeCommandListAppendLaunchMultipleKernelsIndirect" << " [" << time << " ns]";
    if (*(params->pphKernels) != nullptr) {
      std::cerr << " hKernels = " << **(params->pphKernels) << "";
    }
    if (*(params->ppCountBuffer) != nullptr) {
      std::cerr << " CountBuffer = " << **(params->ppCountBuffer) << "";
    }
    if (*(params->pphWaitEvents) != nullptr) {
      std::cerr << " hWaitEvents = " << **(params->pphWaitEvents) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeCommandListAppendLaunchMultipleKernelsIndirect",
                         start_time, end_time);
  }
}

static void zeFenceCreateOnEnter(
    ze_fence_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeFenceCreate" << ":";
    std::cerr << " hCommandQueue = " << *(params->phCommandQueue);
    std::cerr << " desc = " << *(params->pdesc);
    std::cerr << " phFence = " << *(params->pphFence);
    if (*(params->pphFence) != nullptr) {
      std::cerr << " (hFence = " << **(params->pphFence) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeFenceCreateOnExit(
    ze_fence_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeFenceCreate", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeFenceCreate" << " [" << time << " ns]";
    if (*(params->pphFence) != nullptr) {
      std::cerr << " hFence = " << **(params->pphFence) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeFenceCreate",
                         start_time, end_time);
  }
}

static void zeFenceDestroyOnEnter(
    ze_fence_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeFenceDestroy" << ":";
    std::cerr << " hFence = " << *(params->phFence);
    std::cerr << std::endl;
  }
}

static void zeFenceDestroyOnExit(
    ze_fence_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeFenceDestroy", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeFenceDestroy" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeFenceDestroy",
                         start_time, end_time);
  }
}

static void zeFenceHostSynchronizeOnEnter(
    ze_fence_host_synchronize_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeFenceHostSynchronize" << ":";
    std::cerr << " hFence = " << *(params->phFence);
    std::cerr << " timeout = " << *(params->ptimeout);
    std::cerr << std::endl;
  }
}

static void zeFenceHostSynchronizeOnExit(
    ze_fence_host_synchronize_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeFenceHostSynchronize", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeFenceHostSynchronize" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeFenceHostSynchronize",
                         start_time, end_time);
  }
}

static void zeFenceQueryStatusOnEnter(
    ze_fence_query_status_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeFenceQueryStatus" << ":";
    std::cerr << " hFence = " << *(params->phFence);
    std::cerr << std::endl;
  }
}

static void zeFenceQueryStatusOnExit(
    ze_fence_query_status_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeFenceQueryStatus", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeFenceQueryStatus" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeFenceQueryStatus",
                         start_time, end_time);
  }
}

static void zeFenceResetOnEnter(
    ze_fence_reset_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeFenceReset" << ":";
    std::cerr << " hFence = " << *(params->phFence);
    std::cerr << std::endl;
  }
}

static void zeFenceResetOnExit(
    ze_fence_reset_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeFenceReset", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeFenceReset" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeFenceReset",
                         start_time, end_time);
  }
}

static void zeEventPoolCreateOnEnter(
    ze_event_pool_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeEventPoolCreate" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " desc = " << *(params->pdesc);
    std::cerr << " numDevices = " << *(params->pnumDevices);
    std::cerr << " phDevices = " << *(params->pphDevices);
    if (*(params->pphDevices) != nullptr) {
      std::cerr << " (hDevices = " << **(params->pphDevices) << ")";
    }
    std::cerr << " phEventPool = " << *(params->pphEventPool);
    if (*(params->pphEventPool) != nullptr) {
      std::cerr << " (hEventPool = " << **(params->pphEventPool) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeEventPoolCreateOnExit(
    ze_event_pool_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeEventPoolCreate", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeEventPoolCreate" << " [" << time << " ns]";
    if (*(params->pphDevices) != nullptr) {
      std::cerr << " hDevices = " << **(params->pphDevices) << "";
    }
    if (*(params->pphEventPool) != nullptr) {
      std::cerr << " hEventPool = " << **(params->pphEventPool) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeEventPoolCreate",
                         start_time, end_time);
  }
}

static void zeEventPoolDestroyOnEnter(
    ze_event_pool_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeEventPoolDestroy" << ":";
    std::cerr << " hEventPool = " << *(params->phEventPool);
    std::cerr << std::endl;
  }
}

static void zeEventPoolDestroyOnExit(
    ze_event_pool_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeEventPoolDestroy", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeEventPoolDestroy" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeEventPoolDestroy",
                         start_time, end_time);
  }
}

static void zeEventPoolGetIpcHandleOnEnter(
    ze_event_pool_get_ipc_handle_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeEventPoolGetIpcHandle" << ":";
    std::cerr << " hEventPool = " << *(params->phEventPool);
    std::cerr << " phIpc = " << *(params->pphIpc);
    if (*(params->pphIpc) != nullptr) {
      std::cerr << " (hIpc = " << (*(params->pphIpc))->data << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeEventPoolGetIpcHandleOnExit(
    ze_event_pool_get_ipc_handle_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeEventPoolGetIpcHandle", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeEventPoolGetIpcHandle" << " [" << time << " ns]";
    if (*(params->pphIpc) != nullptr) {
      std::cerr << " hIpc = " << (*(params->pphIpc))->data << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeEventPoolGetIpcHandle",
                         start_time, end_time);
  }
}

static void zeEventPoolOpenIpcHandleOnEnter(
    ze_event_pool_open_ipc_handle_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeEventPoolOpenIpcHandle" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " hIpc = " << (params->phIpc)->data;
    std::cerr << " phEventPool = " << *(params->pphEventPool);
    if (*(params->pphEventPool) != nullptr) {
      std::cerr << " (hEventPool = " << **(params->pphEventPool) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeEventPoolOpenIpcHandleOnExit(
    ze_event_pool_open_ipc_handle_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeEventPoolOpenIpcHandle", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeEventPoolOpenIpcHandle" << " [" << time << " ns]";
    if (*(params->pphEventPool) != nullptr) {
      std::cerr << " hEventPool = " << **(params->pphEventPool) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeEventPoolOpenIpcHandle",
                         start_time, end_time);
  }
}

static void zeEventPoolCloseIpcHandleOnEnter(
    ze_event_pool_close_ipc_handle_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeEventPoolCloseIpcHandle" << ":";
    std::cerr << " hEventPool = " << *(params->phEventPool);
    std::cerr << std::endl;
  }
}

static void zeEventPoolCloseIpcHandleOnExit(
    ze_event_pool_close_ipc_handle_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeEventPoolCloseIpcHandle", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeEventPoolCloseIpcHandle" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeEventPoolCloseIpcHandle",
                         start_time, end_time);
  }
}

static void zeEventCreateOnEnter(
    ze_event_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeEventCreate" << ":";
    std::cerr << " hEventPool = " << *(params->phEventPool);
    std::cerr << " desc = " << *(params->pdesc);
    std::cerr << " phEvent = " << *(params->pphEvent);
    if (*(params->pphEvent) != nullptr) {
      std::cerr << " (hEvent = " << **(params->pphEvent) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeEventCreateOnExit(
    ze_event_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeEventCreate", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeEventCreate" << " [" << time << " ns]";
    if (*(params->pphEvent) != nullptr) {
      std::cerr << " hEvent = " << **(params->pphEvent) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeEventCreate",
                         start_time, end_time);
  }
}

static void zeEventDestroyOnEnter(
    ze_event_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeEventDestroy" << ":";
    std::cerr << " hEvent = " << *(params->phEvent);
    std::cerr << std::endl;
  }
}

static void zeEventDestroyOnExit(
    ze_event_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeEventDestroy", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeEventDestroy" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeEventDestroy",
                         start_time, end_time);
  }
}

static void zeEventHostSignalOnEnter(
    ze_event_host_signal_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeEventHostSignal" << ":";
    std::cerr << " hEvent = " << *(params->phEvent);
    std::cerr << std::endl;
  }
}

static void zeEventHostSignalOnExit(
    ze_event_host_signal_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeEventHostSignal", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeEventHostSignal" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeEventHostSignal",
                         start_time, end_time);
  }
}

static void zeEventHostSynchronizeOnEnter(
    ze_event_host_synchronize_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeEventHostSynchronize" << ":";
    std::cerr << " hEvent = " << *(params->phEvent);
    std::cerr << " timeout = " << *(params->ptimeout);
    std::cerr << std::endl;
  }
}

static void zeEventHostSynchronizeOnExit(
    ze_event_host_synchronize_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeEventHostSynchronize", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeEventHostSynchronize" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeEventHostSynchronize",
                         start_time, end_time);
  }
}

static void zeEventQueryStatusOnEnter(
    ze_event_query_status_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeEventQueryStatus" << ":";
    std::cerr << " hEvent = " << *(params->phEvent);
    std::cerr << std::endl;
  }
}

static void zeEventQueryStatusOnExit(
    ze_event_query_status_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeEventQueryStatus", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeEventQueryStatus" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeEventQueryStatus",
                         start_time, end_time);
  }
}

static void zeEventHostResetOnEnter(
    ze_event_host_reset_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeEventHostReset" << ":";
    std::cerr << " hEvent = " << *(params->phEvent);
    std::cerr << std::endl;
  }
}

static void zeEventHostResetOnExit(
    ze_event_host_reset_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeEventHostReset", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeEventHostReset" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeEventHostReset",
                         start_time, end_time);
  }
}

static void zeEventQueryKernelTimestampOnEnter(
    ze_event_query_kernel_timestamp_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeEventQueryKernelTimestamp" << ":";
    std::cerr << " hEvent = " << *(params->phEvent);
    std::cerr << " dstptr = " << *(params->pdstptr);
    std::cerr << std::endl;
  }
}

static void zeEventQueryKernelTimestampOnExit(
    ze_event_query_kernel_timestamp_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeEventQueryKernelTimestamp", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeEventQueryKernelTimestamp" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeEventQueryKernelTimestamp",
                         start_time, end_time);
  }
}

static void zeImageGetPropertiesOnEnter(
    ze_image_get_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeImageGetProperties" << ":";
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " desc = " << *(params->pdesc);
    std::cerr << " pImageProperties = " << *(params->ppImageProperties);
    std::cerr << std::endl;
  }
}

static void zeImageGetPropertiesOnExit(
    ze_image_get_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeImageGetProperties", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeImageGetProperties" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeImageGetProperties",
                         start_time, end_time);
  }
}

static void zeImageCreateOnEnter(
    ze_image_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeImageCreate" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " desc = " << *(params->pdesc);
    std::cerr << " phImage = " << *(params->pphImage);
    if (*(params->pphImage) != nullptr) {
      std::cerr << " (hImage = " << **(params->pphImage) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeImageCreateOnExit(
    ze_image_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeImageCreate", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeImageCreate" << " [" << time << " ns]";
    if (*(params->pphImage) != nullptr) {
      std::cerr << " hImage = " << **(params->pphImage) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeImageCreate",
                         start_time, end_time);
  }
}

static void zeImageDestroyOnEnter(
    ze_image_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeImageDestroy" << ":";
    std::cerr << " hImage = " << *(params->phImage);
    std::cerr << std::endl;
  }
}

static void zeImageDestroyOnExit(
    ze_image_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeImageDestroy", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeImageDestroy" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeImageDestroy",
                         start_time, end_time);
  }
}

static void zeModuleCreateOnEnter(
    ze_module_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeModuleCreate" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " desc = " << *(params->pdesc);
    std::cerr << " phModule = " << *(params->pphModule);
    if (*(params->pphModule) != nullptr) {
      std::cerr << " (hModule = " << **(params->pphModule) << ")";
    }
    std::cerr << " phBuildLog = " << *(params->pphBuildLog);
    if (*(params->pphBuildLog) != nullptr) {
      std::cerr << " (hBuildLog = " << **(params->pphBuildLog) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeModuleCreateOnExit(
    ze_module_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeModuleCreate", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeModuleCreate" << " [" << time << " ns]";
    if (*(params->pphModule) != nullptr) {
      std::cerr << " hModule = " << **(params->pphModule) << "";
    }
    if (*(params->pphBuildLog) != nullptr) {
      std::cerr << " hBuildLog = " << **(params->pphBuildLog) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeModuleCreate",
                         start_time, end_time);
  }
}

static void zeModuleDestroyOnEnter(
    ze_module_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeModuleDestroy" << ":";
    std::cerr << " hModule = " << *(params->phModule);
    std::cerr << std::endl;
  }
}

static void zeModuleDestroyOnExit(
    ze_module_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeModuleDestroy", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeModuleDestroy" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeModuleDestroy",
                         start_time, end_time);
  }
}

static void zeModuleDynamicLinkOnEnter(
    ze_module_dynamic_link_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeModuleDynamicLink" << ":";
    std::cerr << " numModules = " << *(params->pnumModules);
    std::cerr << " phModules = " << *(params->pphModules);
    if (*(params->pphModules) != nullptr) {
      std::cerr << " (hModules = " << **(params->pphModules) << ")";
    }
    std::cerr << " phLinkLog = " << *(params->pphLinkLog);
    if (*(params->pphLinkLog) != nullptr) {
      std::cerr << " (hLinkLog = " << **(params->pphLinkLog) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeModuleDynamicLinkOnExit(
    ze_module_dynamic_link_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeModuleDynamicLink", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeModuleDynamicLink" << " [" << time << " ns]";
    if (*(params->pphModules) != nullptr) {
      std::cerr << " hModules = " << **(params->pphModules) << "";
    }
    if (*(params->pphLinkLog) != nullptr) {
      std::cerr << " hLinkLog = " << **(params->pphLinkLog) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeModuleDynamicLink",
                         start_time, end_time);
  }
}

static void zeModuleGetNativeBinaryOnEnter(
    ze_module_get_native_binary_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeModuleGetNativeBinary" << ":";
    std::cerr << " hModule = " << *(params->phModule);
    std::cerr << " pSize = " << *(params->ppSize);
    std::cerr << " pModuleNativeBinary = " << *(params->ppModuleNativeBinary);
    std::cerr << std::endl;
  }
}

static void zeModuleGetNativeBinaryOnExit(
    ze_module_get_native_binary_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeModuleGetNativeBinary", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeModuleGetNativeBinary" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeModuleGetNativeBinary",
                         start_time, end_time);
  }
}

static void zeModuleGetGlobalPointerOnEnter(
    ze_module_get_global_pointer_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeModuleGetGlobalPointer" << ":";
    std::cerr << " hModule = " << *(params->phModule);
    std::cerr << " pGlobalName = " << *(params->ppGlobalName);
    std::cerr << " pSize = " << *(params->ppSize);
    std::cerr << " pptr = " << *(params->ppptr);
    if (*(params->ppptr) != nullptr) {
      std::cerr << " (ptr = " << **(params->ppptr) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeModuleGetGlobalPointerOnExit(
    ze_module_get_global_pointer_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeModuleGetGlobalPointer", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeModuleGetGlobalPointer" << " [" << time << " ns]";
    if (*(params->ppptr) != nullptr) {
      std::cerr << " ptr = " << **(params->ppptr) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeModuleGetGlobalPointer",
                         start_time, end_time);
  }
}

static void zeModuleGetKernelNamesOnEnter(
    ze_module_get_kernel_names_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeModuleGetKernelNames" << ":";
    std::cerr << " hModule = " << *(params->phModule);
    std::cerr << " pCount = " << *(params->ppCount);
    if (*(params->ppCount) != nullptr) {
      std::cerr << " (Count = " << **(params->ppCount) << ")";
    }
    std::cerr << " pNames = " << *(params->ppNames);
    std::cerr << std::endl;
  }
}

static void zeModuleGetKernelNamesOnExit(
    ze_module_get_kernel_names_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeModuleGetKernelNames", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeModuleGetKernelNames" << " [" << time << " ns]";
    if (*(params->ppCount) != nullptr) {
      std::cerr << " Count = " << **(params->ppCount) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeModuleGetKernelNames",
                         start_time, end_time);
  }
}

static void zeModuleGetPropertiesOnEnter(
    ze_module_get_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeModuleGetProperties" << ":";
    std::cerr << " hModule = " << *(params->phModule);
    std::cerr << " pModuleProperties = " << *(params->ppModuleProperties);
    std::cerr << std::endl;
  }
}

static void zeModuleGetPropertiesOnExit(
    ze_module_get_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeModuleGetProperties", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeModuleGetProperties" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeModuleGetProperties",
                         start_time, end_time);
  }
}

static void zeModuleGetFunctionPointerOnEnter(
    ze_module_get_function_pointer_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeModuleGetFunctionPointer" << ":";
    std::cerr << " hModule = " << *(params->phModule);
    std::cerr << " pFunctionName = " << *(params->ppFunctionName);
    std::cerr << " pfnFunction = " << *(params->ppfnFunction);
    std::cerr << std::endl;
  }
}

static void zeModuleGetFunctionPointerOnExit(
    ze_module_get_function_pointer_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeModuleGetFunctionPointer", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeModuleGetFunctionPointer" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeModuleGetFunctionPointer",
                         start_time, end_time);
  }
}

static void zeModuleBuildLogDestroyOnEnter(
    ze_module_build_log_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeModuleBuildLogDestroy" << ":";
    std::cerr << " hModuleBuildLog = " << *(params->phModuleBuildLog);
    std::cerr << std::endl;
  }
}

static void zeModuleBuildLogDestroyOnExit(
    ze_module_build_log_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeModuleBuildLogDestroy", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeModuleBuildLogDestroy" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeModuleBuildLogDestroy",
                         start_time, end_time);
  }
}

static void zeModuleBuildLogGetStringOnEnter(
    ze_module_build_log_get_string_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeModuleBuildLogGetString" << ":";
    std::cerr << " hModuleBuildLog = " << *(params->phModuleBuildLog);
    std::cerr << " pSize = " << *(params->ppSize);
    std::cerr << " pBuildLog = " << *(params->ppBuildLog);
    std::cerr << std::endl;
  }
}

static void zeModuleBuildLogGetStringOnExit(
    ze_module_build_log_get_string_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeModuleBuildLogGetString", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeModuleBuildLogGetString" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeModuleBuildLogGetString",
                         start_time, end_time);
  }
}

static void zeKernelCreateOnEnter(
    ze_kernel_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeKernelCreate" << ":";
    std::cerr << " hModule = " << *(params->phModule);
    std::cerr << " desc = " << *(params->pdesc);
    std::cerr << " phKernel = " << *(params->pphKernel);
    if (*(params->pphKernel) != nullptr) {
      std::cerr << " (hKernel = " << **(params->pphKernel) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeKernelCreateOnExit(
    ze_kernel_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeKernelCreate", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeKernelCreate" << " [" << time << " ns]";
    if (*(params->pphKernel) != nullptr) {
      std::cerr << " hKernel = " << **(params->pphKernel) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeKernelCreate",
                         start_time, end_time);
  }
}

static void zeKernelDestroyOnEnter(
    ze_kernel_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeKernelDestroy" << ":";
    std::cerr << " hKernel = " << *(params->phKernel);
    std::cerr << std::endl;
  }
}

static void zeKernelDestroyOnExit(
    ze_kernel_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeKernelDestroy", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeKernelDestroy" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeKernelDestroy",
                         start_time, end_time);
  }
}

static void zeKernelSetCacheConfigOnEnter(
    ze_kernel_set_cache_config_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeKernelSetCacheConfig" << ":";
    std::cerr << " hKernel = " << *(params->phKernel);
    std::cerr << " flags = " << *(params->pflags);
    std::cerr << std::endl;
  }
}

static void zeKernelSetCacheConfigOnExit(
    ze_kernel_set_cache_config_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeKernelSetCacheConfig", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeKernelSetCacheConfig" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeKernelSetCacheConfig",
                         start_time, end_time);
  }
}

static void zeKernelSetGroupSizeOnEnter(
    ze_kernel_set_group_size_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeKernelSetGroupSize" << ":";
    std::cerr << " hKernel = " << *(params->phKernel);
    std::cerr << " groupSizeX = " << *(params->pgroupSizeX);
    std::cerr << " groupSizeY = " << *(params->pgroupSizeY);
    std::cerr << " groupSizeZ = " << *(params->pgroupSizeZ);
    std::cerr << std::endl;
  }
}

static void zeKernelSetGroupSizeOnExit(
    ze_kernel_set_group_size_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeKernelSetGroupSize", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeKernelSetGroupSize" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeKernelSetGroupSize",
                         start_time, end_time);
  }
}

static void zeKernelSuggestGroupSizeOnEnter(
    ze_kernel_suggest_group_size_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeKernelSuggestGroupSize" << ":";
    std::cerr << " hKernel = " << *(params->phKernel);
    std::cerr << " globalSizeX = " << *(params->pglobalSizeX);
    std::cerr << " globalSizeY = " << *(params->pglobalSizeY);
    std::cerr << " globalSizeZ = " << *(params->pglobalSizeZ);
    std::cerr << " groupSizeX = " << *(params->pgroupSizeX);
    std::cerr << " groupSizeY = " << *(params->pgroupSizeY);
    std::cerr << " groupSizeZ = " << *(params->pgroupSizeZ);
    std::cerr << std::endl;
  }
}

static void zeKernelSuggestGroupSizeOnExit(
    ze_kernel_suggest_group_size_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeKernelSuggestGroupSize", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeKernelSuggestGroupSize" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeKernelSuggestGroupSize",
                         start_time, end_time);
  }
}

static void zeKernelSuggestMaxCooperativeGroupCountOnEnter(
    ze_kernel_suggest_max_cooperative_group_count_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeKernelSuggestMaxCooperativeGroupCount" << ":";
    std::cerr << " hKernel = " << *(params->phKernel);
    std::cerr << " totalGroupCount = " << *(params->ptotalGroupCount);
    std::cerr << std::endl;
  }
}

static void zeKernelSuggestMaxCooperativeGroupCountOnExit(
    ze_kernel_suggest_max_cooperative_group_count_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeKernelSuggestMaxCooperativeGroupCount", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeKernelSuggestMaxCooperativeGroupCount" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeKernelSuggestMaxCooperativeGroupCount",
                         start_time, end_time);
  }
}

static void zeKernelSetArgumentValueOnEnter(
    ze_kernel_set_argument_value_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeKernelSetArgumentValue" << ":";
    std::cerr << " hKernel = " << *(params->phKernel);
    std::cerr << " argIndex = " << *(params->pargIndex);
    std::cerr << " argSize = " << *(params->pargSize);
    std::cerr << " pArgValue = " << *(params->ppArgValue);
    std::cerr << std::endl;
  }
}

static void zeKernelSetArgumentValueOnExit(
    ze_kernel_set_argument_value_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeKernelSetArgumentValue", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeKernelSetArgumentValue" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeKernelSetArgumentValue",
                         start_time, end_time);
  }
}

static void zeKernelSetIndirectAccessOnEnter(
    ze_kernel_set_indirect_access_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeKernelSetIndirectAccess" << ":";
    std::cerr << " hKernel = " << *(params->phKernel);
    std::cerr << " flags = " << *(params->pflags);
    std::cerr << std::endl;
  }
}

static void zeKernelSetIndirectAccessOnExit(
    ze_kernel_set_indirect_access_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeKernelSetIndirectAccess", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeKernelSetIndirectAccess" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeKernelSetIndirectAccess",
                         start_time, end_time);
  }
}

static void zeKernelGetIndirectAccessOnEnter(
    ze_kernel_get_indirect_access_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeKernelGetIndirectAccess" << ":";
    std::cerr << " hKernel = " << *(params->phKernel);
    std::cerr << " pFlags = " << *(params->ppFlags);
    std::cerr << std::endl;
  }
}

static void zeKernelGetIndirectAccessOnExit(
    ze_kernel_get_indirect_access_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeKernelGetIndirectAccess", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeKernelGetIndirectAccess" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeKernelGetIndirectAccess",
                         start_time, end_time);
  }
}

static void zeKernelGetSourceAttributesOnEnter(
    ze_kernel_get_source_attributes_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeKernelGetSourceAttributes" << ":";
    std::cerr << " hKernel = " << *(params->phKernel);
    std::cerr << " pSize = " << *(params->ppSize);
    std::cerr << " pString = " << *(params->ppString);
    std::cerr << std::endl;
  }
}

static void zeKernelGetSourceAttributesOnExit(
    ze_kernel_get_source_attributes_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeKernelGetSourceAttributes", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeKernelGetSourceAttributes" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeKernelGetSourceAttributes",
                         start_time, end_time);
  }
}

static void zeKernelGetPropertiesOnEnter(
    ze_kernel_get_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeKernelGetProperties" << ":";
    std::cerr << " hKernel = " << *(params->phKernel);
    std::cerr << " pKernelProperties = " << *(params->ppKernelProperties);
    std::cerr << std::endl;
  }
}

static void zeKernelGetPropertiesOnExit(
    ze_kernel_get_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeKernelGetProperties", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeKernelGetProperties" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeKernelGetProperties",
                         start_time, end_time);
  }
}

static void zeKernelGetNameOnEnter(
    ze_kernel_get_name_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeKernelGetName" << ":";
    std::cerr << " hKernel = " << *(params->phKernel);
    std::cerr << " pSize = " << *(params->ppSize);
    std::cerr << " pName = " << *(params->ppName);
    std::cerr << std::endl;
  }
}

static void zeKernelGetNameOnExit(
    ze_kernel_get_name_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeKernelGetName", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeKernelGetName" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeKernelGetName",
                         start_time, end_time);
  }
}

static void zeSamplerCreateOnEnter(
    ze_sampler_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeSamplerCreate" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " desc = " << *(params->pdesc);
    std::cerr << " phSampler = " << *(params->pphSampler);
    if (*(params->pphSampler) != nullptr) {
      std::cerr << " (hSampler = " << **(params->pphSampler) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeSamplerCreateOnExit(
    ze_sampler_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeSamplerCreate", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeSamplerCreate" << " [" << time << " ns]";
    if (*(params->pphSampler) != nullptr) {
      std::cerr << " hSampler = " << **(params->pphSampler) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeSamplerCreate",
                         start_time, end_time);
  }
}

static void zeSamplerDestroyOnEnter(
    ze_sampler_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeSamplerDestroy" << ":";
    std::cerr << " hSampler = " << *(params->phSampler);
    std::cerr << std::endl;
  }
}

static void zeSamplerDestroyOnExit(
    ze_sampler_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeSamplerDestroy", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeSamplerDestroy" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeSamplerDestroy",
                         start_time, end_time);
  }
}

static void zePhysicalMemCreateOnEnter(
    ze_physical_mem_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zePhysicalMemCreate" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " desc = " << *(params->pdesc);
    std::cerr << " phPhysicalMemory = " << *(params->pphPhysicalMemory);
    if (*(params->pphPhysicalMemory) != nullptr) {
      std::cerr << " (hPhysicalMemory = " << **(params->pphPhysicalMemory) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zePhysicalMemCreateOnExit(
    ze_physical_mem_create_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zePhysicalMemCreate", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zePhysicalMemCreate" << " [" << time << " ns]";
    if (*(params->pphPhysicalMemory) != nullptr) {
      std::cerr << " hPhysicalMemory = " << **(params->pphPhysicalMemory) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zePhysicalMemCreate",
                         start_time, end_time);
  }
}

static void zePhysicalMemDestroyOnEnter(
    ze_physical_mem_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zePhysicalMemDestroy" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " hPhysicalMemory = " << *(params->phPhysicalMemory);
    std::cerr << std::endl;
  }
}

static void zePhysicalMemDestroyOnExit(
    ze_physical_mem_destroy_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zePhysicalMemDestroy", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zePhysicalMemDestroy" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zePhysicalMemDestroy",
                         start_time, end_time);
  }
}

static void zeMemAllocSharedOnEnter(
    ze_mem_alloc_shared_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeMemAllocShared" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " device_desc = " << *(params->pdevice_desc);
    std::cerr << " host_desc = " << *(params->phost_desc);
    std::cerr << " size = " << *(params->psize);
    std::cerr << " alignment = " << *(params->palignment);
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " pptr = " << *(params->ppptr);
    if (*(params->ppptr) != nullptr) {
      std::cerr << " (ptr = " << **(params->ppptr) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeMemAllocSharedOnExit(
    ze_mem_alloc_shared_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeMemAllocShared", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeMemAllocShared" << " [" << time << " ns]";
    if (*(params->ppptr) != nullptr) {
      std::cerr << " ptr = " << **(params->ppptr) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeMemAllocShared",
                         start_time, end_time);
  }
}

static void zeMemAllocDeviceOnEnter(
    ze_mem_alloc_device_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeMemAllocDevice" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " device_desc = " << *(params->pdevice_desc);
    std::cerr << " size = " << *(params->psize);
    std::cerr << " alignment = " << *(params->palignment);
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " pptr = " << *(params->ppptr);
    if (*(params->ppptr) != nullptr) {
      std::cerr << " (ptr = " << **(params->ppptr) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeMemAllocDeviceOnExit(
    ze_mem_alloc_device_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeMemAllocDevice", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeMemAllocDevice" << " [" << time << " ns]";
    if (*(params->ppptr) != nullptr) {
      std::cerr << " ptr = " << **(params->ppptr) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeMemAllocDevice",
                         start_time, end_time);
  }
}

static void zeMemAllocHostOnEnter(
    ze_mem_alloc_host_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeMemAllocHost" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " host_desc = " << *(params->phost_desc);
    std::cerr << " size = " << *(params->psize);
    std::cerr << " alignment = " << *(params->palignment);
    std::cerr << " pptr = " << *(params->ppptr);
    if (*(params->ppptr) != nullptr) {
      std::cerr << " (ptr = " << **(params->ppptr) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeMemAllocHostOnExit(
    ze_mem_alloc_host_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeMemAllocHost", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeMemAllocHost" << " [" << time << " ns]";
    if (*(params->ppptr) != nullptr) {
      std::cerr << " ptr = " << **(params->ppptr) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeMemAllocHost",
                         start_time, end_time);
  }
}

static void zeMemFreeOnEnter(
    ze_mem_free_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeMemFree" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " ptr = " << *(params->pptr);
    std::cerr << std::endl;
  }
}

static void zeMemFreeOnExit(
    ze_mem_free_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeMemFree", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeMemFree" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeMemFree",
                         start_time, end_time);
  }
}

static void zeMemGetAllocPropertiesOnEnter(
    ze_mem_get_alloc_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeMemGetAllocProperties" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " ptr = " << *(params->pptr);
    std::cerr << " pMemAllocProperties = " << *(params->ppMemAllocProperties);
    std::cerr << " phDevice = " << *(params->pphDevice);
    if (*(params->pphDevice) != nullptr) {
      std::cerr << " (hDevice = " << **(params->pphDevice) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeMemGetAllocPropertiesOnExit(
    ze_mem_get_alloc_properties_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeMemGetAllocProperties", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeMemGetAllocProperties" << " [" << time << " ns]";
    if (*(params->pphDevice) != nullptr) {
      std::cerr << " hDevice = " << **(params->pphDevice) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeMemGetAllocProperties",
                         start_time, end_time);
  }
}

static void zeMemGetAddressRangeOnEnter(
    ze_mem_get_address_range_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeMemGetAddressRange" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " ptr = " << *(params->pptr);
    std::cerr << " pBase = " << *(params->ppBase);
    std::cerr << " pSize = " << *(params->ppSize);
    std::cerr << std::endl;
  }
}

static void zeMemGetAddressRangeOnExit(
    ze_mem_get_address_range_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeMemGetAddressRange", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeMemGetAddressRange" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeMemGetAddressRange",
                         start_time, end_time);
  }
}

static void zeMemGetIpcHandleOnEnter(
    ze_mem_get_ipc_handle_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeMemGetIpcHandle" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " ptr = " << *(params->pptr);
    std::cerr << " pIpcHandle = " << *(params->ppIpcHandle);
    std::cerr << std::endl;
  }
}

static void zeMemGetIpcHandleOnExit(
    ze_mem_get_ipc_handle_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeMemGetIpcHandle", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeMemGetIpcHandle" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeMemGetIpcHandle",
                         start_time, end_time);
  }
}

static void zeMemOpenIpcHandleOnEnter(
    ze_mem_open_ipc_handle_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeMemOpenIpcHandle" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " handle = " << (params->phandle)->data;
    std::cerr << " flags = " << *(params->pflags);
    std::cerr << " pptr = " << *(params->ppptr);
    if (*(params->ppptr) != nullptr) {
      std::cerr << " (ptr = " << **(params->ppptr) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeMemOpenIpcHandleOnExit(
    ze_mem_open_ipc_handle_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeMemOpenIpcHandle", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeMemOpenIpcHandle" << " [" << time << " ns]";
    if (*(params->ppptr) != nullptr) {
      std::cerr << " ptr = " << **(params->ppptr) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeMemOpenIpcHandle",
                         start_time, end_time);
  }
}

static void zeMemCloseIpcHandleOnEnter(
    ze_mem_close_ipc_handle_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeMemCloseIpcHandle" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " ptr = " << *(params->pptr);
    std::cerr << std::endl;
  }
}

static void zeMemCloseIpcHandleOnExit(
    ze_mem_close_ipc_handle_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeMemCloseIpcHandle", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeMemCloseIpcHandle" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeMemCloseIpcHandle",
                         start_time, end_time);
  }
}

static void zeVirtualMemReserveOnEnter(
    ze_virtual_mem_reserve_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeVirtualMemReserve" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " pStart = " << *(params->ppStart);
    std::cerr << " size = " << *(params->psize);
    std::cerr << " pptr = " << *(params->ppptr);
    if (*(params->ppptr) != nullptr) {
      std::cerr << " (ptr = " << **(params->ppptr) << ")";
    }
    std::cerr << std::endl;
  }
}

static void zeVirtualMemReserveOnExit(
    ze_virtual_mem_reserve_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeVirtualMemReserve", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeVirtualMemReserve" << " [" << time << " ns]";
    if (*(params->ppptr) != nullptr) {
      std::cerr << " ptr = " << **(params->ppptr) << "";
    }
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeVirtualMemReserve",
                         start_time, end_time);
  }
}

static void zeVirtualMemFreeOnEnter(
    ze_virtual_mem_free_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeVirtualMemFree" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " ptr = " << *(params->pptr);
    std::cerr << " size = " << *(params->psize);
    std::cerr << std::endl;
  }
}

static void zeVirtualMemFreeOnExit(
    ze_virtual_mem_free_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeVirtualMemFree", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeVirtualMemFree" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeVirtualMemFree",
                         start_time, end_time);
  }
}

static void zeVirtualMemQueryPageSizeOnEnter(
    ze_virtual_mem_query_page_size_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeVirtualMemQueryPageSize" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " hDevice = " << *(params->phDevice);
    std::cerr << " size = " << *(params->psize);
    std::cerr << " pagesize = " << *(params->ppagesize);
    std::cerr << std::endl;
  }
}

static void zeVirtualMemQueryPageSizeOnExit(
    ze_virtual_mem_query_page_size_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeVirtualMemQueryPageSize", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeVirtualMemQueryPageSize" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeVirtualMemQueryPageSize",
                         start_time, end_time);
  }
}

static void zeVirtualMemMapOnEnter(
    ze_virtual_mem_map_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeVirtualMemMap" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " ptr = " << *(params->pptr);
    std::cerr << " size = " << *(params->psize);
    std::cerr << " hPhysicalMemory = " << *(params->phPhysicalMemory);
    std::cerr << " offset = " << *(params->poffset);
    std::cerr << " access = " << *(params->paccess);
    std::cerr << " (";
    switch (*(params->paccess)) {
      case 2147483647:
        std::cerr << "ZE_MEMORY_ACCESS_ATTRIBUTE_FORCE_UINT32";
        break;
      case 0:
        std::cerr << "ZE_MEMORY_ACCESS_ATTRIBUTE_NONE";
        break;
      case 1:
        std::cerr << "ZE_MEMORY_ACCESS_ATTRIBUTE_READWRITE";
        break;
      case 2:
        std::cerr << "ZE_MEMORY_ACCESS_ATTRIBUTE_READONLY";
        break;
      default:
        std::cerr << "<UNKNOWN>";
        break;
    }
    std::cerr << ")";
    std::cerr << std::endl;
  }
}

static void zeVirtualMemMapOnExit(
    ze_virtual_mem_map_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeVirtualMemMap", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeVirtualMemMap" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeVirtualMemMap",
                         start_time, end_time);
  }
}

static void zeVirtualMemUnmapOnEnter(
    ze_virtual_mem_unmap_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeVirtualMemUnmap" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " ptr = " << *(params->pptr);
    std::cerr << " size = " << *(params->psize);
    std::cerr << std::endl;
  }
}

static void zeVirtualMemUnmapOnExit(
    ze_virtual_mem_unmap_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeVirtualMemUnmap", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeVirtualMemUnmap" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeVirtualMemUnmap",
                         start_time, end_time);
  }
}

static void zeVirtualMemSetAccessAttributeOnEnter(
    ze_virtual_mem_set_access_attribute_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeVirtualMemSetAccessAttribute" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " ptr = " << *(params->pptr);
    std::cerr << " size = " << *(params->psize);
    std::cerr << " access = " << *(params->paccess);
    std::cerr << " (";
    switch (*(params->paccess)) {
      case 2147483647:
        std::cerr << "ZE_MEMORY_ACCESS_ATTRIBUTE_FORCE_UINT32";
        break;
      case 0:
        std::cerr << "ZE_MEMORY_ACCESS_ATTRIBUTE_NONE";
        break;
      case 1:
        std::cerr << "ZE_MEMORY_ACCESS_ATTRIBUTE_READWRITE";
        break;
      case 2:
        std::cerr << "ZE_MEMORY_ACCESS_ATTRIBUTE_READONLY";
        break;
      default:
        std::cerr << "<UNKNOWN>";
        break;
    }
    std::cerr << ")";
    std::cerr << std::endl;
  }
}

static void zeVirtualMemSetAccessAttributeOnExit(
    ze_virtual_mem_set_access_attribute_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeVirtualMemSetAccessAttribute", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeVirtualMemSetAccessAttribute" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeVirtualMemSetAccessAttribute",
                         start_time, end_time);
  }
}

static void zeVirtualMemGetAccessAttributeOnEnter(
    ze_virtual_mem_get_access_attribute_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  start_time = collector->GetTimestamp();
  if (collector->call_tracing_) {
    std::cerr << ">>>> [" << start_time << "] ";
    std::cerr << "zeVirtualMemGetAccessAttribute" << ":";
    std::cerr << " hContext = " << *(params->phContext);
    std::cerr << " ptr = " << *(params->pptr);
    std::cerr << " size = " << *(params->psize);
    std::cerr << " access = " << *(params->paccess);
    std::cerr << " outSize = " << *(params->poutSize);
    std::cerr << std::endl;
  }
}

static void zeVirtualMemGetAccessAttributeOnExit(
    ze_virtual_mem_get_access_attribute_params_t* params,
    ze_result_t result,
    void* global_user_data,
    void** instance_user_data) {
  PTI_ASSERT(global_user_data != nullptr);
  ZeApiCollector* collector = reinterpret_cast<ZeApiCollector*>(global_user_data);
  uint64_t end_time = collector->GetTimestamp();

  uint64_t& start_time = *reinterpret_cast<uint64_t*>(instance_user_data);
  PTI_ASSERT(start_time > 0);
  PTI_ASSERT(start_time < end_time);
  uint64_t time = end_time - start_time;
  collector->AddFunctionTime("zeVirtualMemGetAccessAttribute", time);
  if (collector->call_tracing_) {
    std::cerr << "<<<< [" << end_time << "] ";
    std::cerr << "zeVirtualMemGetAccessAttribute" << " [" << time << " ns]";
    std::cerr << " -> " << GetResultString(result) << 
      " (" << result << ")" << std::endl;
  }

  if (collector->callback_ != nullptr) {
    collector->callback_(collector->callback_data_,
                         "zeVirtualMemGetAccessAttribute",
                         start_time, end_time);
  }
}

static void SetTracingAPIs(zet_tracer_exp_handle_t tracer) {
  zet_core_callbacks_t prologue = {};
  zet_core_callbacks_t epilogue = {};

  prologue.Global.pfnInitCb = zeInitOnEnter;
  epilogue.Global.pfnInitCb = zeInitOnExit;
  prologue.Driver.pfnGetCb = zeDriverGetOnEnter;
  epilogue.Driver.pfnGetCb = zeDriverGetOnExit;
  prologue.Driver.pfnGetApiVersionCb = zeDriverGetApiVersionOnEnter;
  epilogue.Driver.pfnGetApiVersionCb = zeDriverGetApiVersionOnExit;
  prologue.Driver.pfnGetPropertiesCb = zeDriverGetPropertiesOnEnter;
  epilogue.Driver.pfnGetPropertiesCb = zeDriverGetPropertiesOnExit;
  prologue.Driver.pfnGetIpcPropertiesCb = zeDriverGetIpcPropertiesOnEnter;
  epilogue.Driver.pfnGetIpcPropertiesCb = zeDriverGetIpcPropertiesOnExit;
  prologue.Driver.pfnGetExtensionPropertiesCb = zeDriverGetExtensionPropertiesOnEnter;
  epilogue.Driver.pfnGetExtensionPropertiesCb = zeDriverGetExtensionPropertiesOnExit;
  prologue.Device.pfnGetCb = zeDeviceGetOnEnter;
  epilogue.Device.pfnGetCb = zeDeviceGetOnExit;
  prologue.Device.pfnGetSubDevicesCb = zeDeviceGetSubDevicesOnEnter;
  epilogue.Device.pfnGetSubDevicesCb = zeDeviceGetSubDevicesOnExit;
  prologue.Device.pfnGetPropertiesCb = zeDeviceGetPropertiesOnEnter;
  epilogue.Device.pfnGetPropertiesCb = zeDeviceGetPropertiesOnExit;
  prologue.Device.pfnGetComputePropertiesCb = zeDeviceGetComputePropertiesOnEnter;
  epilogue.Device.pfnGetComputePropertiesCb = zeDeviceGetComputePropertiesOnExit;
  prologue.Device.pfnGetModulePropertiesCb = zeDeviceGetModulePropertiesOnEnter;
  epilogue.Device.pfnGetModulePropertiesCb = zeDeviceGetModulePropertiesOnExit;
  prologue.Device.pfnGetCommandQueueGroupPropertiesCb = zeDeviceGetCommandQueueGroupPropertiesOnEnter;
  epilogue.Device.pfnGetCommandQueueGroupPropertiesCb = zeDeviceGetCommandQueueGroupPropertiesOnExit;
  prologue.Device.pfnGetMemoryPropertiesCb = zeDeviceGetMemoryPropertiesOnEnter;
  epilogue.Device.pfnGetMemoryPropertiesCb = zeDeviceGetMemoryPropertiesOnExit;
  prologue.Device.pfnGetMemoryAccessPropertiesCb = zeDeviceGetMemoryAccessPropertiesOnEnter;
  epilogue.Device.pfnGetMemoryAccessPropertiesCb = zeDeviceGetMemoryAccessPropertiesOnExit;
  prologue.Device.pfnGetCachePropertiesCb = zeDeviceGetCachePropertiesOnEnter;
  epilogue.Device.pfnGetCachePropertiesCb = zeDeviceGetCachePropertiesOnExit;
  prologue.Device.pfnGetImagePropertiesCb = zeDeviceGetImagePropertiesOnEnter;
  epilogue.Device.pfnGetImagePropertiesCb = zeDeviceGetImagePropertiesOnExit;
  prologue.Device.pfnGetExternalMemoryPropertiesCb = zeDeviceGetExternalMemoryPropertiesOnEnter;
  epilogue.Device.pfnGetExternalMemoryPropertiesCb = zeDeviceGetExternalMemoryPropertiesOnExit;
  prologue.Device.pfnGetP2PPropertiesCb = zeDeviceGetP2PPropertiesOnEnter;
  epilogue.Device.pfnGetP2PPropertiesCb = zeDeviceGetP2PPropertiesOnExit;
  prologue.Device.pfnCanAccessPeerCb = zeDeviceCanAccessPeerOnEnter;
  epilogue.Device.pfnCanAccessPeerCb = zeDeviceCanAccessPeerOnExit;
  prologue.Device.pfnGetStatusCb = zeDeviceGetStatusOnEnter;
  epilogue.Device.pfnGetStatusCb = zeDeviceGetStatusOnExit;
  prologue.Context.pfnCreateCb = zeContextCreateOnEnter;
  epilogue.Context.pfnCreateCb = zeContextCreateOnExit;
  prologue.Context.pfnDestroyCb = zeContextDestroyOnEnter;
  epilogue.Context.pfnDestroyCb = zeContextDestroyOnExit;
  prologue.Context.pfnGetStatusCb = zeContextGetStatusOnEnter;
  epilogue.Context.pfnGetStatusCb = zeContextGetStatusOnExit;
  prologue.Context.pfnSystemBarrierCb = zeContextSystemBarrierOnEnter;
  epilogue.Context.pfnSystemBarrierCb = zeContextSystemBarrierOnExit;
  prologue.Context.pfnMakeMemoryResidentCb = zeContextMakeMemoryResidentOnEnter;
  epilogue.Context.pfnMakeMemoryResidentCb = zeContextMakeMemoryResidentOnExit;
  prologue.Context.pfnEvictMemoryCb = zeContextEvictMemoryOnEnter;
  epilogue.Context.pfnEvictMemoryCb = zeContextEvictMemoryOnExit;
  prologue.Context.pfnMakeImageResidentCb = zeContextMakeImageResidentOnEnter;
  epilogue.Context.pfnMakeImageResidentCb = zeContextMakeImageResidentOnExit;
  prologue.Context.pfnEvictImageCb = zeContextEvictImageOnEnter;
  epilogue.Context.pfnEvictImageCb = zeContextEvictImageOnExit;
  prologue.CommandQueue.pfnCreateCb = zeCommandQueueCreateOnEnter;
  epilogue.CommandQueue.pfnCreateCb = zeCommandQueueCreateOnExit;
  prologue.CommandQueue.pfnDestroyCb = zeCommandQueueDestroyOnEnter;
  epilogue.CommandQueue.pfnDestroyCb = zeCommandQueueDestroyOnExit;
  prologue.CommandQueue.pfnExecuteCommandListsCb = zeCommandQueueExecuteCommandListsOnEnter;
  epilogue.CommandQueue.pfnExecuteCommandListsCb = zeCommandQueueExecuteCommandListsOnExit;
  prologue.CommandQueue.pfnSynchronizeCb = zeCommandQueueSynchronizeOnEnter;
  epilogue.CommandQueue.pfnSynchronizeCb = zeCommandQueueSynchronizeOnExit;
  prologue.CommandList.pfnCreateCb = zeCommandListCreateOnEnter;
  epilogue.CommandList.pfnCreateCb = zeCommandListCreateOnExit;
  prologue.CommandList.pfnCreateImmediateCb = zeCommandListCreateImmediateOnEnter;
  epilogue.CommandList.pfnCreateImmediateCb = zeCommandListCreateImmediateOnExit;
  prologue.CommandList.pfnDestroyCb = zeCommandListDestroyOnEnter;
  epilogue.CommandList.pfnDestroyCb = zeCommandListDestroyOnExit;
  prologue.CommandList.pfnCloseCb = zeCommandListCloseOnEnter;
  epilogue.CommandList.pfnCloseCb = zeCommandListCloseOnExit;
  prologue.CommandList.pfnResetCb = zeCommandListResetOnEnter;
  epilogue.CommandList.pfnResetCb = zeCommandListResetOnExit;
  prologue.CommandList.pfnAppendWriteGlobalTimestampCb = zeCommandListAppendWriteGlobalTimestampOnEnter;
  epilogue.CommandList.pfnAppendWriteGlobalTimestampCb = zeCommandListAppendWriteGlobalTimestampOnExit;
  prologue.CommandList.pfnAppendBarrierCb = zeCommandListAppendBarrierOnEnter;
  epilogue.CommandList.pfnAppendBarrierCb = zeCommandListAppendBarrierOnExit;
  prologue.CommandList.pfnAppendMemoryRangesBarrierCb = zeCommandListAppendMemoryRangesBarrierOnEnter;
  epilogue.CommandList.pfnAppendMemoryRangesBarrierCb = zeCommandListAppendMemoryRangesBarrierOnExit;
  prologue.CommandList.pfnAppendMemoryCopyCb = zeCommandListAppendMemoryCopyOnEnter;
  epilogue.CommandList.pfnAppendMemoryCopyCb = zeCommandListAppendMemoryCopyOnExit;
  prologue.CommandList.pfnAppendMemoryFillCb = zeCommandListAppendMemoryFillOnEnter;
  epilogue.CommandList.pfnAppendMemoryFillCb = zeCommandListAppendMemoryFillOnExit;
  prologue.CommandList.pfnAppendMemoryCopyRegionCb = zeCommandListAppendMemoryCopyRegionOnEnter;
  epilogue.CommandList.pfnAppendMemoryCopyRegionCb = zeCommandListAppendMemoryCopyRegionOnExit;
  prologue.CommandList.pfnAppendMemoryCopyFromContextCb = zeCommandListAppendMemoryCopyFromContextOnEnter;
  epilogue.CommandList.pfnAppendMemoryCopyFromContextCb = zeCommandListAppendMemoryCopyFromContextOnExit;
  prologue.CommandList.pfnAppendImageCopyCb = zeCommandListAppendImageCopyOnEnter;
  epilogue.CommandList.pfnAppendImageCopyCb = zeCommandListAppendImageCopyOnExit;
  prologue.CommandList.pfnAppendImageCopyRegionCb = zeCommandListAppendImageCopyRegionOnEnter;
  epilogue.CommandList.pfnAppendImageCopyRegionCb = zeCommandListAppendImageCopyRegionOnExit;
  prologue.CommandList.pfnAppendImageCopyToMemoryCb = zeCommandListAppendImageCopyToMemoryOnEnter;
  epilogue.CommandList.pfnAppendImageCopyToMemoryCb = zeCommandListAppendImageCopyToMemoryOnExit;
  prologue.CommandList.pfnAppendImageCopyFromMemoryCb = zeCommandListAppendImageCopyFromMemoryOnEnter;
  epilogue.CommandList.pfnAppendImageCopyFromMemoryCb = zeCommandListAppendImageCopyFromMemoryOnExit;
  prologue.CommandList.pfnAppendMemoryPrefetchCb = zeCommandListAppendMemoryPrefetchOnEnter;
  epilogue.CommandList.pfnAppendMemoryPrefetchCb = zeCommandListAppendMemoryPrefetchOnExit;
  prologue.CommandList.pfnAppendMemAdviseCb = zeCommandListAppendMemAdviseOnEnter;
  epilogue.CommandList.pfnAppendMemAdviseCb = zeCommandListAppendMemAdviseOnExit;
  prologue.CommandList.pfnAppendSignalEventCb = zeCommandListAppendSignalEventOnEnter;
  epilogue.CommandList.pfnAppendSignalEventCb = zeCommandListAppendSignalEventOnExit;
  prologue.CommandList.pfnAppendWaitOnEventsCb = zeCommandListAppendWaitOnEventsOnEnter;
  epilogue.CommandList.pfnAppendWaitOnEventsCb = zeCommandListAppendWaitOnEventsOnExit;
  prologue.CommandList.pfnAppendEventResetCb = zeCommandListAppendEventResetOnEnter;
  epilogue.CommandList.pfnAppendEventResetCb = zeCommandListAppendEventResetOnExit;
  prologue.CommandList.pfnAppendQueryKernelTimestampsCb = zeCommandListAppendQueryKernelTimestampsOnEnter;
  epilogue.CommandList.pfnAppendQueryKernelTimestampsCb = zeCommandListAppendQueryKernelTimestampsOnExit;
  prologue.CommandList.pfnAppendLaunchKernelCb = zeCommandListAppendLaunchKernelOnEnter;
  epilogue.CommandList.pfnAppendLaunchKernelCb = zeCommandListAppendLaunchKernelOnExit;
  prologue.CommandList.pfnAppendLaunchCooperativeKernelCb = zeCommandListAppendLaunchCooperativeKernelOnEnter;
  epilogue.CommandList.pfnAppendLaunchCooperativeKernelCb = zeCommandListAppendLaunchCooperativeKernelOnExit;
  prologue.CommandList.pfnAppendLaunchKernelIndirectCb = zeCommandListAppendLaunchKernelIndirectOnEnter;
  epilogue.CommandList.pfnAppendLaunchKernelIndirectCb = zeCommandListAppendLaunchKernelIndirectOnExit;
  prologue.CommandList.pfnAppendLaunchMultipleKernelsIndirectCb = zeCommandListAppendLaunchMultipleKernelsIndirectOnEnter;
  epilogue.CommandList.pfnAppendLaunchMultipleKernelsIndirectCb = zeCommandListAppendLaunchMultipleKernelsIndirectOnExit;
  prologue.Fence.pfnCreateCb = zeFenceCreateOnEnter;
  epilogue.Fence.pfnCreateCb = zeFenceCreateOnExit;
  prologue.Fence.pfnDestroyCb = zeFenceDestroyOnEnter;
  epilogue.Fence.pfnDestroyCb = zeFenceDestroyOnExit;
  prologue.Fence.pfnHostSynchronizeCb = zeFenceHostSynchronizeOnEnter;
  epilogue.Fence.pfnHostSynchronizeCb = zeFenceHostSynchronizeOnExit;
  prologue.Fence.pfnQueryStatusCb = zeFenceQueryStatusOnEnter;
  epilogue.Fence.pfnQueryStatusCb = zeFenceQueryStatusOnExit;
  prologue.Fence.pfnResetCb = zeFenceResetOnEnter;
  epilogue.Fence.pfnResetCb = zeFenceResetOnExit;
  prologue.EventPool.pfnCreateCb = zeEventPoolCreateOnEnter;
  epilogue.EventPool.pfnCreateCb = zeEventPoolCreateOnExit;
  prologue.EventPool.pfnDestroyCb = zeEventPoolDestroyOnEnter;
  epilogue.EventPool.pfnDestroyCb = zeEventPoolDestroyOnExit;
  prologue.EventPool.pfnGetIpcHandleCb = zeEventPoolGetIpcHandleOnEnter;
  epilogue.EventPool.pfnGetIpcHandleCb = zeEventPoolGetIpcHandleOnExit;
  prologue.EventPool.pfnOpenIpcHandleCb = zeEventPoolOpenIpcHandleOnEnter;
  epilogue.EventPool.pfnOpenIpcHandleCb = zeEventPoolOpenIpcHandleOnExit;
  prologue.EventPool.pfnCloseIpcHandleCb = zeEventPoolCloseIpcHandleOnEnter;
  epilogue.EventPool.pfnCloseIpcHandleCb = zeEventPoolCloseIpcHandleOnExit;
  prologue.Event.pfnCreateCb = zeEventCreateOnEnter;
  epilogue.Event.pfnCreateCb = zeEventCreateOnExit;
  prologue.Event.pfnDestroyCb = zeEventDestroyOnEnter;
  epilogue.Event.pfnDestroyCb = zeEventDestroyOnExit;
  prologue.Event.pfnHostSignalCb = zeEventHostSignalOnEnter;
  epilogue.Event.pfnHostSignalCb = zeEventHostSignalOnExit;
  prologue.Event.pfnHostSynchronizeCb = zeEventHostSynchronizeOnEnter;
  epilogue.Event.pfnHostSynchronizeCb = zeEventHostSynchronizeOnExit;
  prologue.Event.pfnQueryStatusCb = zeEventQueryStatusOnEnter;
  epilogue.Event.pfnQueryStatusCb = zeEventQueryStatusOnExit;
  prologue.Event.pfnHostResetCb = zeEventHostResetOnEnter;
  epilogue.Event.pfnHostResetCb = zeEventHostResetOnExit;
  prologue.Event.pfnQueryKernelTimestampCb = zeEventQueryKernelTimestampOnEnter;
  epilogue.Event.pfnQueryKernelTimestampCb = zeEventQueryKernelTimestampOnExit;
  prologue.Image.pfnGetPropertiesCb = zeImageGetPropertiesOnEnter;
  epilogue.Image.pfnGetPropertiesCb = zeImageGetPropertiesOnExit;
  prologue.Image.pfnCreateCb = zeImageCreateOnEnter;
  epilogue.Image.pfnCreateCb = zeImageCreateOnExit;
  prologue.Image.pfnDestroyCb = zeImageDestroyOnEnter;
  epilogue.Image.pfnDestroyCb = zeImageDestroyOnExit;
  prologue.Module.pfnCreateCb = zeModuleCreateOnEnter;
  epilogue.Module.pfnCreateCb = zeModuleCreateOnExit;
  prologue.Module.pfnDestroyCb = zeModuleDestroyOnEnter;
  epilogue.Module.pfnDestroyCb = zeModuleDestroyOnExit;
  prologue.Module.pfnDynamicLinkCb = zeModuleDynamicLinkOnEnter;
  epilogue.Module.pfnDynamicLinkCb = zeModuleDynamicLinkOnExit;
  prologue.Module.pfnGetNativeBinaryCb = zeModuleGetNativeBinaryOnEnter;
  epilogue.Module.pfnGetNativeBinaryCb = zeModuleGetNativeBinaryOnExit;
  prologue.Module.pfnGetGlobalPointerCb = zeModuleGetGlobalPointerOnEnter;
  epilogue.Module.pfnGetGlobalPointerCb = zeModuleGetGlobalPointerOnExit;
  prologue.Module.pfnGetKernelNamesCb = zeModuleGetKernelNamesOnEnter;
  epilogue.Module.pfnGetKernelNamesCb = zeModuleGetKernelNamesOnExit;
  prologue.Module.pfnGetPropertiesCb = zeModuleGetPropertiesOnEnter;
  epilogue.Module.pfnGetPropertiesCb = zeModuleGetPropertiesOnExit;
  prologue.Module.pfnGetFunctionPointerCb = zeModuleGetFunctionPointerOnEnter;
  epilogue.Module.pfnGetFunctionPointerCb = zeModuleGetFunctionPointerOnExit;
  prologue.ModuleBuildLog.pfnDestroyCb = zeModuleBuildLogDestroyOnEnter;
  epilogue.ModuleBuildLog.pfnDestroyCb = zeModuleBuildLogDestroyOnExit;
  prologue.ModuleBuildLog.pfnGetStringCb = zeModuleBuildLogGetStringOnEnter;
  epilogue.ModuleBuildLog.pfnGetStringCb = zeModuleBuildLogGetStringOnExit;
  prologue.Kernel.pfnCreateCb = zeKernelCreateOnEnter;
  epilogue.Kernel.pfnCreateCb = zeKernelCreateOnExit;
  prologue.Kernel.pfnDestroyCb = zeKernelDestroyOnEnter;
  epilogue.Kernel.pfnDestroyCb = zeKernelDestroyOnExit;
  prologue.Kernel.pfnSetCacheConfigCb = zeKernelSetCacheConfigOnEnter;
  epilogue.Kernel.pfnSetCacheConfigCb = zeKernelSetCacheConfigOnExit;
  prologue.Kernel.pfnSetGroupSizeCb = zeKernelSetGroupSizeOnEnter;
  epilogue.Kernel.pfnSetGroupSizeCb = zeKernelSetGroupSizeOnExit;
  prologue.Kernel.pfnSuggestGroupSizeCb = zeKernelSuggestGroupSizeOnEnter;
  epilogue.Kernel.pfnSuggestGroupSizeCb = zeKernelSuggestGroupSizeOnExit;
  prologue.Kernel.pfnSuggestMaxCooperativeGroupCountCb = zeKernelSuggestMaxCooperativeGroupCountOnEnter;
  epilogue.Kernel.pfnSuggestMaxCooperativeGroupCountCb = zeKernelSuggestMaxCooperativeGroupCountOnExit;
  prologue.Kernel.pfnSetArgumentValueCb = zeKernelSetArgumentValueOnEnter;
  epilogue.Kernel.pfnSetArgumentValueCb = zeKernelSetArgumentValueOnExit;
  prologue.Kernel.pfnSetIndirectAccessCb = zeKernelSetIndirectAccessOnEnter;
  epilogue.Kernel.pfnSetIndirectAccessCb = zeKernelSetIndirectAccessOnExit;
  prologue.Kernel.pfnGetIndirectAccessCb = zeKernelGetIndirectAccessOnEnter;
  epilogue.Kernel.pfnGetIndirectAccessCb = zeKernelGetIndirectAccessOnExit;
  prologue.Kernel.pfnGetSourceAttributesCb = zeKernelGetSourceAttributesOnEnter;
  epilogue.Kernel.pfnGetSourceAttributesCb = zeKernelGetSourceAttributesOnExit;
  prologue.Kernel.pfnGetPropertiesCb = zeKernelGetPropertiesOnEnter;
  epilogue.Kernel.pfnGetPropertiesCb = zeKernelGetPropertiesOnExit;
  prologue.Kernel.pfnGetNameCb = zeKernelGetNameOnEnter;
  epilogue.Kernel.pfnGetNameCb = zeKernelGetNameOnExit;
  prologue.Sampler.pfnCreateCb = zeSamplerCreateOnEnter;
  epilogue.Sampler.pfnCreateCb = zeSamplerCreateOnExit;
  prologue.Sampler.pfnDestroyCb = zeSamplerDestroyOnEnter;
  epilogue.Sampler.pfnDestroyCb = zeSamplerDestroyOnExit;
  prologue.PhysicalMem.pfnCreateCb = zePhysicalMemCreateOnEnter;
  epilogue.PhysicalMem.pfnCreateCb = zePhysicalMemCreateOnExit;
  prologue.PhysicalMem.pfnDestroyCb = zePhysicalMemDestroyOnEnter;
  epilogue.PhysicalMem.pfnDestroyCb = zePhysicalMemDestroyOnExit;
  prologue.Mem.pfnAllocSharedCb = zeMemAllocSharedOnEnter;
  epilogue.Mem.pfnAllocSharedCb = zeMemAllocSharedOnExit;
  prologue.Mem.pfnAllocDeviceCb = zeMemAllocDeviceOnEnter;
  epilogue.Mem.pfnAllocDeviceCb = zeMemAllocDeviceOnExit;
  prologue.Mem.pfnAllocHostCb = zeMemAllocHostOnEnter;
  epilogue.Mem.pfnAllocHostCb = zeMemAllocHostOnExit;
  prologue.Mem.pfnFreeCb = zeMemFreeOnEnter;
  epilogue.Mem.pfnFreeCb = zeMemFreeOnExit;
  prologue.Mem.pfnGetAllocPropertiesCb = zeMemGetAllocPropertiesOnEnter;
  epilogue.Mem.pfnGetAllocPropertiesCb = zeMemGetAllocPropertiesOnExit;
  prologue.Mem.pfnGetAddressRangeCb = zeMemGetAddressRangeOnEnter;
  epilogue.Mem.pfnGetAddressRangeCb = zeMemGetAddressRangeOnExit;
  prologue.Mem.pfnGetIpcHandleCb = zeMemGetIpcHandleOnEnter;
  epilogue.Mem.pfnGetIpcHandleCb = zeMemGetIpcHandleOnExit;
  prologue.Mem.pfnOpenIpcHandleCb = zeMemOpenIpcHandleOnEnter;
  epilogue.Mem.pfnOpenIpcHandleCb = zeMemOpenIpcHandleOnExit;
  prologue.Mem.pfnCloseIpcHandleCb = zeMemCloseIpcHandleOnEnter;
  epilogue.Mem.pfnCloseIpcHandleCb = zeMemCloseIpcHandleOnExit;
  prologue.VirtualMem.pfnReserveCb = zeVirtualMemReserveOnEnter;
  epilogue.VirtualMem.pfnReserveCb = zeVirtualMemReserveOnExit;
  prologue.VirtualMem.pfnFreeCb = zeVirtualMemFreeOnEnter;
  epilogue.VirtualMem.pfnFreeCb = zeVirtualMemFreeOnExit;
  prologue.VirtualMem.pfnQueryPageSizeCb = zeVirtualMemQueryPageSizeOnEnter;
  epilogue.VirtualMem.pfnQueryPageSizeCb = zeVirtualMemQueryPageSizeOnExit;
  prologue.VirtualMem.pfnMapCb = zeVirtualMemMapOnEnter;
  epilogue.VirtualMem.pfnMapCb = zeVirtualMemMapOnExit;
  prologue.VirtualMem.pfnUnmapCb = zeVirtualMemUnmapOnEnter;
  epilogue.VirtualMem.pfnUnmapCb = zeVirtualMemUnmapOnExit;
  prologue.VirtualMem.pfnSetAccessAttributeCb = zeVirtualMemSetAccessAttributeOnEnter;
  epilogue.VirtualMem.pfnSetAccessAttributeCb = zeVirtualMemSetAccessAttributeOnExit;
  prologue.VirtualMem.pfnGetAccessAttributeCb = zeVirtualMemGetAccessAttributeOnEnter;
  epilogue.VirtualMem.pfnGetAccessAttributeCb = zeVirtualMemGetAccessAttributeOnExit;

  ze_result_t status = ZE_RESULT_SUCCESS;
  status = zetTracerExpSetPrologues(tracer, &prologue);
  PTI_ASSERT(status == ZE_RESULT_SUCCESS);
  status = zetTracerExpSetEpilogues(tracer, &epilogue);
  PTI_ASSERT(status == ZE_RESULT_SUCCESS);
}

